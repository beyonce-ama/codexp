import{r as c,j as e,K as xs,L as Xe}from"./app-BZc_oFYi.js";import{a as G,A as Be,T as ce}from"./app-layout-DBT5_MVf.js";import{A as hs}from"./AnimatedBackground-C26HjF_X.js";import{L as Ue}from"./loader-circle-CFkSRZsT.js";import{A as ps}from"./activity-CgDwVDm7.js";import{M as ze}from"./medal-BrYz_U0Z.js";import{S as X,U as us,C as fs}from"./users-CDKYlX_u.js";import{Z as Fe}from"./zap-jNLdl9bY.js";import{T as W}from"./trophy-D1z0We-f.js";import{M as gs,i as bs,u as He,P as js,a as vs,b as Ns,L as ys,m as ws}from"./proxy-DucLz0mR.js";import{C as Oe}from"./circle-check-big-yESg0rGq.js";import{S as oe,a as _s}from"./x-Lgijrn4d.js";import{C as ks}from"./crown-DaGPCtrd.js";import{C as Cs}from"./cpu-DwgEeLnz.js";import{T as Ge}from"./trending-up-DLlPSZTy.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-BuXfeoj0.js";class Ss extends c.Component{getSnapshotBeforeUpdate(i){const t=this.props.childRef.current;if(t&&i.isPresent&&!this.props.isPresent){const f=t.offsetParent,b=bs(f)&&f.offsetWidth||0,m=this.props.sizeRef.current;m.height=t.offsetHeight||0,m.width=t.offsetWidth||0,m.top=t.offsetTop,m.left=t.offsetLeft,m.right=b-m.width-m.left}return null}componentDidUpdate(){}render(){return this.props.children}}function As({children:d,isPresent:i,anchorX:t,root:f}){const b=c.useId(),m=c.useRef(null),S=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:T}=c.useContext(gs);return c.useInsertionEffect(()=>{const{width:I,height:p,top:P,left:u,right:h}=S.current;if(i||!m.current||!I||!p)return;const y=t==="left"?`left: ${u}`:`right: ${h}`;m.current.dataset.motionPopId=b;const j=document.createElement("style");T&&(j.nonce=T);const w=f??document.head;return w.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${b}"] {
            position: absolute !important;
            width: ${I}px !important;
            height: ${p}px !important;
            ${y}px !important;
            top: ${P}px !important;
          }
        `),()=>{w.contains(j)&&w.removeChild(j)}},[i]),e.jsx(Ss,{isPresent:i,childRef:m,sizeRef:S,children:c.cloneElement(d,{ref:m})})}const Ps=({children:d,initial:i,isPresent:t,onExitComplete:f,custom:b,presenceAffectsLayout:m,mode:S,anchorX:T,root:I})=>{const p=He(Ls),P=c.useId();let u=!0,h=c.useMemo(()=>(u=!1,{id:P,initial:i,isPresent:t,custom:b,onExitComplete:y=>{p.set(y,!0);for(const j of p.values())if(!j)return;f&&f()},register:y=>(p.set(y,!1),()=>p.delete(y))}),[t,p,f]);return m&&u&&(h={...h}),c.useMemo(()=>{p.forEach((y,j)=>p.set(j,!1))},[t]),c.useEffect(()=>{!t&&!p.size&&f&&f()},[t]),S==="popLayout"&&(d=e.jsx(As,{isPresent:t,anchorX:T,root:I,children:d})),e.jsx(js.Provider,{value:h,children:d})};function Ls(){return new Map}const te=d=>d.key||"";function Ye(d){const i=[];return c.Children.forEach(d,t=>{c.isValidElement(t)&&i.push(t)}),i}const $s=({children:d,custom:i,initial:t=!0,onExitComplete:f,presenceAffectsLayout:b=!0,mode:m="sync",propagate:S=!1,anchorX:T="left",root:I})=>{const[p,P]=vs(S),u=c.useMemo(()=>Ye(d),[d]),h=S&&!p?[]:u.map(te),y=c.useRef(!0),j=c.useRef(u),w=He(()=>new Map),[ae,Y]=c.useState(u),[L,K]=c.useState(u);Ns(()=>{y.current=!1,j.current=u;for(let N=0;N<L.length;N++){const x=te(L[N]);h.includes(x)?w.delete(x):w.get(x)!==!0&&w.set(x,!1)}},[L,h.length,h.join("-")]);const B=[];if(u!==ae){let N=[...u];for(let x=0;x<L.length;x++){const $=L[x],D=te($);h.includes(D)||(N.splice(x,0,$),B.push($))}return m==="wait"&&B.length&&(N=B),K(Ye(N)),Y(u),null}const{forceRender:U}=c.useContext(ys);return e.jsx(e.Fragment,{children:L.map(N=>{const x=te(N),$=S&&!p?!1:u===L||h.includes(x),D=()=>{if(w.has(x))w.set(x,!0);else return;let z=!0;w.forEach(H=>{H||(z=!1)}),z&&(U==null||U(),K(j.current),S&&(P==null||P()),f&&f())};return e.jsx(Ps,{isPresent:$,initial:!y.current||t?void 0:!1,custom:i,presenceAffectsLayout:b,mode:m,root:I,onExitComplete:$?void 0:D,anchorX:T,children:N},x)})})},Ke=[{title:"Home",href:"/dashboard"},{title:"Dashboard",href:"/dashboard"}],Es=d=>Math.floor(d/10)+1,Je=d=>d%10,Ms=d=>Je(d)/10*100;function Zs(){var pe,ue,fe,ge,be,je,ve,Ne,ye,we,_e,ke,Ce,Se,Ae,Pe,Le,$e,Ee,Me,Te,We,Ie,De;const{auth:d}=xs().props,i=d==null?void 0:d.user,[t,f]=c.useState(null),[b,m]=c.useState([]),[S,T]=c.useState(!0),[I,p]=c.useState(!1),[P,u]=c.useState(null),[h,y]=c.useState([]),[j,w]=c.useState(0),ae=s=>{switch(s){case"Solo":return"bg-blue-900/30 border-blue-800 text-blue-300";case"Solo+AI":return"bg-indigo-900/30 border-indigo-800 text-indigo-300";case"Invite Duel":return"bg-rose-900/30 border-rose-800 text-rose-300";case"Live Match":return"bg-amber-900/30 border-amber-800 text-amber-300";case"Python":return"bg-emerald-900/30 border-emerald-800 text-emerald-300";case"Java":return"bg-orange-900/30 border-orange-800 text-orange-300";case"C++":return"bg-blue-900/30 border-blue-800 text-blue-300";default:return"bg-slate-900/30 border-slate-700 text-slate-300"}},Y=s=>{if(!s)return null;const l=String(s).trim();return/^(https?:\/\/|data:)/i.test(l)||l.startsWith("/")?l:l.startsWith("avatars/")||l.startsWith("storage/")?`/${l}`:`/avatars/${l}`},L=s=>s?s.startsWith("SOLO_AI_")?"Solo+AI":s.startsWith("SOLO_")?"Solo":s.startsWith("PVP_INVITE_")?"Invite Duel":s.startsWith("PVP_LIVE_")?"Live Match":s.startsWith("LANG_PY_")?"Python":s.startsWith("LANG_JAVA_")?"Java":s.startsWith("LANG_CPP_")?"C++":"General":"General",K=s=>s&&typeof s=="object"&&("code"in s||"threshold"in s||"xp_reward"in s||"name"in s||"goal"in s),B=s=>{const l=Number(s.threshold??s.goal??0),a=Number(s.current??s.count??0),r=s.progress!=null?Number(s.progress):l>0?Math.min(100,Math.round(a/l*100)):0,n=Number.isFinite(r)?Math.max(0,Math.min(100,r)):0,v=l>0&&a>=l||n>=100,k=!!(s.claimed??s.is_claimed??!1),E=!!(s.unlocked??v),g=!!(s.can_claim??(E&&!k)),M=s.code??s.key??s.name??"",ee=s.name??s.title??s.code,se=s.description??s.desc,C=s.icon_key??s.icon,o=s.xp_reward??s.xp,A=s.stars_reward??s.stars,O=s.scope??s.category??s.group;return{id:Number.isFinite(Number(s.id))?Number(s.id):void 0,code:String(M),name:String(ee??"Achievement"),description:se??void 0,icon_key:C??null,threshold:l,current:a,progress:n,unlocked:E,claimed:k,can_claim:g,xp_reward:Number(o??0),stars_reward:Number(A??0),__scope:O??L(String(M))}},U=s=>{const l=[],a=n=>{if(!n)return;if(Array.isArray(n)){n.forEach(a);return}if(typeof n!="object")return;if(K(n)){l.push(B(n));return}const v=[n.items,n.achievements,n.tasks,n.groups,n.categories,n.data].filter(Boolean);v.length?v.forEach(a):Object.values(n).forEach(a)};a(s);const r=new Set;return l.filter(n=>{const v=n.id!=null?`id:${n.id}`:`code:${n.code}|scope:${n.__scope??""}`;return r.has(v)?!1:(r.add(v),!0)})};c.useEffect(()=>{N(!0)},[]);const N=async(s=!1)=>{var l,a,r,n,v;try{s&&T(!0);const[k,E,g]=await Promise.all([G.get("/api/me/stats"),G.get("/api/users/participants"),G.get("/api/achievements/progress")]),M=((l=g==null?void 0:g.data)==null?void 0:l.items)??((a=g==null?void 0:g.data)==null?void 0:a.data)??(g==null?void 0:g.data)??g,ee=U(M);if(y(ee),ts){const se=ee.filter(C=>C.can_claim);for(const C of se)try{const o=await G.post("/api/achievements/claim",{achievement_id:C.id}),A=((r=o==null?void 0:o.data)==null?void 0:r.xp_reward)??C.xp_reward??0,O=((n=o==null?void 0:o.data)==null?void 0:n.stars_reward)??C.stars_reward??0;he({name:C.name,xp:A,stars:O,icon_key:C.icon_key??void 0})}catch(o){console.error("Auto-claim failed",C.id,o)}}if(w(Number((M==null?void 0:M.solo_completed)??(M==null?void 0:M.completed)??((v=g==null?void 0:g.data)==null?void 0:v.solo_completed)??0)),k!=null&&k.success&&k.data&&(f(k.data),u(new Date)),E!=null&&E.success&&Array.isArray(E.data)){const C=E.data.map(o=>{var Re,Ve;const A=Number(o.total_xp??0),O=(Re=o.user)==null?void 0:Re.stars,os=o.stars,ds=Number(O??os??0),ms=Y(o.avatar??((Ve=o.profile)==null?void 0:Ve.avatar)??null);return{id:o.id,name:o.name,email:o.email,avatar:ms,total_xp:A,stars:ds,level:Math.floor(A/10)+1}}).sort((o,A)=>A.total_xp-o.total_xp||A.stars-o.stars).map((o,A)=>({...o,rank:A+1}));m(C)}}catch(k){console.error("Error fetching dashboard/leaderboard:",k)}finally{T(!1),p(!1)}},x=((pe=t==null?void 0:t.user)==null?void 0:pe.stars)??((ue=t==null?void 0:t.totals)==null?void 0:ue.stars)??0,$=(fe=t==null?void 0:t.solo_stats)!=null&&fe.total_attempts?Math.round(t.solo_stats.successful_attempts/t.solo_stats.total_attempts*100):0,D=(ge=t==null?void 0:t.ai_stats)!=null&&ge.ai_attempts?Math.round(t.ai_stats.ai_successful_attempts/t.ai_stats.ai_attempts*100):0,z=(((be=t==null?void 0:t.solo_stats)==null?void 0:be.total_attempts)||0)+(((je=t==null?void 0:t.ai_stats)==null?void 0:je.ai_attempts)||0),H=(((ve=t==null?void 0:t.solo_stats)==null?void 0:ve.successful_attempts)||0)+(((Ne=t==null?void 0:t.ai_stats)==null?void 0:Ne.ai_successful_attempts)||0),J=z>0?Math.round(H/z*100):0,Ze=(t==null?void 0:t.duels_played)??0,qe=(t==null?void 0:t.duels_won)??0,Qe=(t==null?void 0:t.live_played)??(t==null?void 0:t.matches_played)??0,es=(t==null?void 0:t.live_won)??(t==null?void 0:t.matches_won)??0,Z=Ze+Qe,le=qe+es,ss=Z?Math.round(le/Z*100):0,re=b.find(s=>s.id===(i==null?void 0:i.id)),F=(re==null?void 0:re.rank)??null,[de,me]=c.useState(null),ts=!0,[as,q]=c.useState(!1),ne=c.useRef(null);c.useEffect(()=>{const s=a=>{ne.current&&(ne.current.contains(a.target)||q(!1))},l=a=>{a.key==="Escape"&&q(!1)};return document.addEventListener("mousedown",s),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",l)}},[]);const[ls,xe]=c.useState([]),he=s=>{const l=`${Date.now()}-${Math.random().toString(36).slice(2)}`;xe(a=>[...a,{id:l,...s}]),setTimeout(()=>xe(a=>a.filter(r=>r.id!==l)),3500)},rs=async s=>{var l,a;try{me(s);const r=h.find(E=>E.id===s),n=await G.post("/api/achievements/claim",{achievement_id:s}),v=((l=n==null?void 0:n.data)==null?void 0:l.xp_reward)??(r==null?void 0:r.xp_reward)??0,k=((a=n==null?void 0:n.data)==null?void 0:a.stars_reward)??(r==null?void 0:r.stars_reward)??0;he({name:(r==null?void 0:r.name)||"Achievement",xp:v,stars:k,icon_key:(r==null?void 0:r.icon_key)??void 0}),await N(!1)}catch(r){console.error("Claim failed",r)}finally{me(null)}},Q=Es(((ye=t==null?void 0:t.totals)==null?void 0:ye.xp)||0),ie=Je(((we=t==null?void 0:t.totals)==null?void 0:we.xp)||0),ns=Ms(((_e=t==null?void 0:t.totals)==null?void 0:_e.xp)||0),is=s=>s===1?{label:"Gold",className:"text-yellow-400",chip:"bg-yellow-500/15 border-yellow-700"}:s===2?{label:"Silver",className:"text-slate-200",chip:"bg-slate-400/10 border-slate-500"}:s===3?{label:"Bronze",className:"text-amber-500",chip:"bg-amber-500/10 border-amber-600"}:{label:"",className:"text-slate-300",chip:"bg-slate-800 border-slate-700"},V=({title:s,right:l,children:a,className:r=""})=>e.jsxs("section",{className:`bg-slate-800/50 border border-slate-700 rounded-2xl p-5 ${r}`,children:[e.jsxs("header",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-semibold tracking-wide",children:s}),l]}),a]}),R=({icon:s,label:l,value:a})=>e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900/60 border border-slate-700 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-800 border border-slate-700",children:e.jsx(s,{className:"h-5 w-5 text-cyan-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:l}),e.jsx("p",{className:"text-base font-semibold text-white",children:a})]})]}),cs=({value:s})=>e.jsx("div",{className:"w-full h-3 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-cyan-500 via-blue-500 to-fuchsia-500",style:{width:`${s}%`}})}),_=({title:s,value:l,icon:a,description:r,tone:n="slate"})=>{const v={slate:"bg-slate-900/60 border-slate-700 text-slate-200",green:"bg-emerald-900/30 border-emerald-800 text-emerald-300",indigo:"bg-indigo-900/30 border-indigo-800 text-indigo-300",amber:"bg-amber-900/30 border-amber-800 text-amber-300",rose:"bg-rose-900/30 border-rose-800 text-rose-300",purple:"bg-purple-900/30 border-purple-800 text-purple-300",cyan:"bg-cyan-900/30 border-cyan-800 text-cyan-300",blue:"bg-blue-900/30 border-blue-800 text-blue-300",yellow:"bg-yellow-900/30 border-yellow-800 text-yellow-300",red:"bg-red-900/30 border-red-800 text-red-300"};return e.jsx("div",{className:`rounded-xl border p-4 ${v[n]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:l}),r&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:r})]})]})})};return S?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:e.jsxs(Be,{breadcrumbs:Ke,children:[e.jsx(Xe,{title:"Dashboard"}),e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ue,{className:"h-8 w-8 animate-spin mx-auto mb-3 text-cyan-400"}),e.jsx("div",{className:"text-slate-300",children:"Loading your dashboard…"})]})})]})}):e.jsxs("div",{className:"min-h-screen relative overflow-x-hidden scroll-smooth",children:[e.jsx("div",{className:"pointer-events-none fixed inset-0 -z-10","aria-hidden":"true",children:e.jsx(hs,{})}),e.jsxs(Be,{breadcrumbs:Ke,children:[e.jsx(Xe,{title:"Dashboard"}),e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ps,{className:"h-7 w-7 text-cyan-400"}),e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:["Welcome back, ",i==null?void 0:i.name,"!"]})]}),e.jsxs("p",{className:"text-slate-400",children:["Ready for your next coding challenge?",P&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• Updated ",P.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[F!=null&&e.jsx(R,{icon:ze,label:"Rank",value:`#${F}`}),e.jsx(R,{icon:X,label:"Stars",value:x}),e.jsx(R,{icon:Fe,label:"Total XP",value:((ke=t==null?void 0:t.totals)==null?void 0:ke.xp)??0}),e.jsxs("div",{ref:ne,className:"relative",children:[e.jsxs("button",{onClick:()=>q(s=>!s),className:"inline-flex items-center gap-2 rounded-xl px-4 py-2 bg-slate-800 border border-slate-700 text-white hover:bg-slate-700",title:"View Achievements",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{children:"Achievements"})]}),e.jsx($s,{children:as&&e.jsx(ws.div,{initial:{opacity:0,y:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-6,scale:.98},transition:{type:"spring",stiffness:380,damping:28,mass:.6},className:"absolute right-0 mt-2 w-[28rem] max-w-[90vw] z-[60]",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-900/95 shadow-2xl backdrop-blur p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("h3",{className:"text-white font-semibold tracking-wide text-sm",children:"Achievements"})]}),e.jsx("button",{onClick:()=>q(!1),className:"inline-flex items-center justify-center rounded-lg border border-slate-600 text-slate-200 hover:bg-slate-800 w-7 h-7",title:"Close",children:"✕"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"My Trophies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.filter(s=>s.claimed).length===0?e.jsx("span",{className:"text-slate-500 text-xs",children:"No trophies yet."}):h.filter(s=>s.claimed).slice(0,12).map(s=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-700 bg-slate-900/60 px-2 py-1",children:[s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,alt:s.icon_key||"trophy",className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-[11px] text-white truncate max-w-[180px]",title:s.name,children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"Tasks"}),h.filter(s=>!s.claimed).length===0?e.jsx("div",{className:"text-slate-400 text-sm",children:"No tasks available."}):(()=>{const s=a=>a.can_claim?3:a.unlocked?2:a.progress>0?1:0,l=[...h].filter(a=>!a.claimed).sort((a,r)=>{const n=s(r)-s(a);return n!==0?n:r.progress-a.progress});return e.jsx("div",{className:"space-y-2 max-h-[45vh] overflow-y-auto pr-1",children:l.slice(0,8).map(a=>{const r=L(a.code);return e.jsx("div",{className:`rounded-xl border p-3 ${a.unlocked?"bg-yellow-900/10 border-yellow-800":"bg-slate-900/60 border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:a.icon_key?e.jsx("img",{src:`/trophies/${a.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("p",{className:"text-white font-medium truncate",title:a.name,children:a.name}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full border ${ae(r)}`,children:r})]}),a.can_claim?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-amber-900/30 border border-amber-800 text-amber-300",children:"Ready to claim"}):a.unlocked?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-yellow-900/20 border border-yellow-800 text-yellow-300",children:"Completed"}):a.progress>0?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-cyan-900/30 border border-cyan-800 text-cyan-300",children:"In progress"}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-slate-800 border border-slate-600 text-slate-300",children:"Locked"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-2 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a.unlocked?"bg-gradient-to-r from-yellow-400 to-amber-500":"bg-gradient-to-r from-cyan-500 to-blue-500"}`,style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mt-1",children:[e.jsxs("span",{children:[Math.min(a.current,a.threshold)," / ",a.threshold]}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-[10px] text-slate-400",children:["Reward: ",e.jsxs("span",{className:"text-white font-medium",children:["+",a.xp_reward," XP"]})," •"," ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3 text-yellow-400"})," ",a.stars_reward]})]}),a.can_claim&&e.jsx("button",{onClick:()=>rs(a.id),disabled:de===a.id,className:"text-[11px] inline-flex items-center gap-2 px-2.5 py-1 rounded-lg border border-yellow-700 bg-yellow-500/10 text-yellow-200 hover:bg-yellow-500/20 disabled:opacity-60",children:de===a.id?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-3.5 w-3.5 animate-spin"}),"Claiming…"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3.5 w-3.5"}),"Claim"]})})]})]})]})]})},a.id)})})})()]})]})})})]})]})]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs(V,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Level & Progress"})]}),right:e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-slate-400",children:"Next Level"}),e.jsxs("div",{className:"font-semibold text-cyan-300",children:[10-ie," XP needed"]})]}),children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white text-lg font-semibold",children:["Level ",Q]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",ie,"/10 XP)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 w-full md:w-auto",children:[e.jsx(R,{icon:ce,label:"Attempts",value:(((Ce=t==null?void 0:t.solo_stats)==null?void 0:Ce.total_attempts)||0)+(((Se=t==null?void 0:t.ai_stats)==null?void 0:Se.ai_attempts)||0)}),e.jsx(R,{icon:Oe,label:"Success",value:`${J}%`}),e.jsx(R,{icon:oe,label:"Duels",value:Z}),e.jsx(R,{icon:W,label:"Wins",value:le})]})]}),e.jsx(cs,{value:Math.round(ns)}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2",children:[e.jsxs("span",{children:["Level ",Q]}),e.jsxs("span",{children:[ie," / 10 XP"]}),e.jsxs("span",{children:["Level ",Q+1]})]})]}),e.jsxs(V,{title:"Your KPIs",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Total XP",value:((Ae=t==null?void 0:t.totals)==null?void 0:Ae.xp)||0,icon:Fe,tone:"yellow"}),e.jsx(_,{title:"Total Attempts",value:(((Pe=t==null?void 0:t.solo_stats)==null?void 0:Pe.total_attempts)||0)+(((Le=t==null?void 0:t.ai_stats)==null?void 0:Le.ai_attempts)||0),icon:ce,tone:"blue"}),e.jsx(_,{title:"Solo Attempts",value:(($e=t==null?void 0:t.solo_stats)==null?void 0:$e.total_attempts)||0,icon:us,tone:"indigo"}),e.jsx(_,{title:"AI Attempts",value:((Ee=t==null?void 0:t.ai_stats)==null?void 0:Ee.ai_attempts)||0,icon:Cs,tone:"cyan"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(_,{title:"Overall Success",value:`${J}%`,icon:Ge,description:`${H} successful attempts`,tone:J>70?"green":J>50?"blue":"amber"}),e.jsx(_,{title:"Solo Success",value:`${$}%`,icon:Oe,description:`${((Me=t==null?void 0:t.solo_stats)==null?void 0:Me.successful_attempts)||0} successful solo attempts`,tone:$>70?"green":$>50?"blue":"amber"}),e.jsx(_,{title:"AI Success",value:`${D}%`,icon:_s,description:`${((Te=t==null?void 0:t.ai_stats)==null?void 0:Te.ai_successful_attempts)||0} successful AI attempts`,tone:D>70?"green":D>50?"blue":"amber"})]})]}),e.jsx(V,{title:"Duel Performance",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Stars Earned",value:x,icon:X,description:"Achievement stars",tone:"purple"}),e.jsx(_,{title:"Duels Played",value:Z,icon:oe,description:"Total matches (invite + live)",tone:"red"}),e.jsx(_,{title:"Duels Won",value:le,icon:W,description:"Victories (invite + live)",tone:"green"}),e.jsx(_,{title:"Win Rate",value:`${ss}%`,icon:Ge,description:"Success percentage",tone:"indigo"})]})}),e.jsx(V,{title:"Today's Activity",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-blue-900/30 border border-blue-800 mb-2",children:e.jsx(ce,{className:"h-6 w-6 text-blue-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((We=t==null?void 0:t.solo_stats)==null?void 0:We.attempts_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Solo Attempts Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-rose-900/30 border border-rose-800 mb-2",children:e.jsx(oe,{className:"h-6 w-6 text-rose-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(t==null?void 0:t.duels_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Duels Started Today"})]})]})}),(t==null?void 0:t.language_stats)&&t.language_stats.length>0&&e.jsx(V,{title:"Language Proficiency",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols- gap-4",children:t.language_stats.map(s=>e.jsx(_,{title:s.language,value:`${s.winrate}%`,icon:fs,description:`${s.games_played} games played`,tone:s.winrate>70?"green":s.winrate>50?"blue":"amber"},s.id))})})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(V,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Leaderboard"})]}),right:e.jsx("span",{className:"text-xs text-slate-400",children:"XP • Stars"}),className:"xl:sticky xl:top-4 xl:self-start",children:[b.slice(0,3).length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:b.slice(0,3).map(s=>{const l=is(s.rank);return e.jsxs("div",{className:`rounded-xl p-3 border ${l.chip} text-center`,children:[e.jsx("div",{className:"mt-2 mx-auto w-12 h-12 rounded-full overflow-hidden ring-1 ring-slate-700/60",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ze,{className:`h-5 w-5 ${l.className}`}),e.jsxs("span",{className:`text-sm font-semibold ${l.className}`,children:["#",s.rank]})]}),e.jsx("div",{className:"mt-1 text-white text-sm font-bold truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"text-[11px] text-slate-400",children:["Lvl ",s.level]}),e.jsxs("div",{className:"mt-1 text-xs text-cyan-300",children:[s.total_xp," XP"]})]},s.id)})}),e.jsxs("div",{className:"divide-y divide-slate-700/70 overflow-y-visible no-scrollbar",children:[b.slice(3,12).map(s=>e.jsxs("div",{className:"py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:`text-sm font-bold ${s.rank<=3?"text-yellow-400":"text-slate-300"}`,children:["#",s.rank]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-white font-medium truncate ${s.id===(i==null?void 0:i.id)?"underline decoration-dotted":""}`,title:s.name,children:s.id===(i==null?void 0:i.id)?"You":s.name}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",s.level]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.total_xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id)),b.length===0&&e.jsx("div",{className:"py-8 text-center text-slate-400",children:"No participants yet."})]}),F!=null&&F>12&&e.jsxs("div",{className:"mt-3 rounded-xl border border-cyan-800 bg-cyan-900/20 p-3",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Your Position"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:"text-sm font-bold text-cyan-300",children:["#",F]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:Y(((Ie=i==null?void 0:i.profile)==null?void 0:Ie.avatar)??(i==null?void 0:i.avatar)??null)||"/avatars/default.png",alt:i==null?void 0:i.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium truncate",children:"You"}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",Q]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[((De=t==null?void 0:t.totals)==null?void 0:De.xp)??0," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3 text-yellow-400"})," ",x]})]})]})]})]})]})})]}),e.jsx("div",{className:"fixed top-4 right-4 z-[60] space-y-2",children:ls.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-yellow-700 bg-slate-900/90 backdrop-blur px-4 py-3 shadow-lg",children:[e.jsx("div",{className:"p-2 rounded-lg border border-yellow-700 bg-yellow-500/10",children:s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm text-white font-semibold truncate",title:s.name,children:["Achievement Unlocked: ",s.name]}),e.jsxs("p",{className:"text-xs text-slate-300",children:["+",s.xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id))})]}),e.jsx("style",{children:`
  .no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `})]})}export{Zs as default};
