import{K as qe,r as o,j as e,L as We}from"./app-ExH8qdyL.js";import{a as F,S as O,A as Pe,V as Ue,c as Ve,U as he,C as be,T as He}from"./app-layout-Cnk4JgaE.js";import{T as Qe}from"./timer-9bc1DHyi.js";import{c as ve}from"./createLucideIcon-ChMfbEcg.js";import{C as ge}from"./circle-check-big-CKlG4fBH.js";import{C as se}from"./circle-x-Cys2OsWP.js";import{B as Ge}from"./bolt-DS_7QNmi.js";import{C as Ke}from"./code-xml-C3hVnPCx.js";import{Z as Ze}from"./zap-BjSM4gGn.js";import{T as Je}from"./trophy-C2n1wCkA.js";import{E as et}from"./eye-FV-pPT7r.js";import{C as tt}from"./crown-CMlLWIki.js";import"./utils-jAU0Cazi.js";import"./users-DKeo6YKr.js";import"./x-L9iKGM8E.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]],rt=ve("Hourglass",st);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],we=ve("Radio",at),re=d=>d?d.split("?")[0]:null,nt=d=>{if(!d)return".png";const s=re(d).match(/\.(png|jpg|jpeg|webp|gif)$/i);return s?s[0]:".png"},ot=d=>d?re(d).replace(/\.(png|jpg|jpeg|webp|gif)$/i,"").replace(/_(sad|think|smirk)$/i,""):null,it=d=>{if(!d)return null;let s=re(d);return/^https?:\/\//i.test(s)||s.startsWith("//")||(s=s.replace(/^\/?public\//i,"/"),s.startsWith("/")||(s="/"+s),s=s.replace(/([^:])\/{2,}/g,"$1/")),s},S=(d,s="think")=>{const n=it(d);if(!n)return null;const m=ot(n);if(!m)return n;const j=nt(n),h=s==="base"?"":`_${s}`;return`${`${m}${h}${j}`}?v=${Date.now()}`},A=d=>new Promise(s=>{const n=new Image;n.onload=()=>s(!0),n.onerror=()=>s(!1),n.src=d}),ct=async(d,s,n)=>{const m=s==="base"?["base","think"]:[s,"think","base"];for(const j of m){const h=S(d,j);if(h&&await A(h))return h}return n??await A(S(d,"base"))?S(d,"base"):null},ye=d=>(d==null?void 0:d.toLowerCase())==="cpp"?"C++":(d??"").toUpperCase(),lt=({active:d,type:s="win"})=>{const[n,m]=o.useState([]);return o.useEffect(()=>{if(d){const j=[],h=s==="win"?["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a","#ffb347"]:["#4ade80","#22d3ee","#fbbf24","#f472b6","#a78bfa","#60a5fa"];for(let b=0;b<70;b++)j.push({id:b,style:{left:"50%",top:"50%",backgroundColor:h[Math.floor(Math.random()*h.length)],transform:`rotate(${Math.random()*360}deg)`,opacity:0,width:`${8+Math.random()*8}px`,height:`${8+Math.random()*8}px`,borderRadius:Math.random()>.5?"50%":"0%"}});m(j),setTimeout(()=>{m(b=>b.map(T=>({...T,style:{...T.style,left:`${50+(Math.random()*100-50)}%`,top:`${50+(Math.random()*100-50)}%`,opacity:1,transition:`all ${.8+Math.random()*.7}s ease-out`}})))},10),setTimeout(()=>{m([])},4e3)}},[d,s]),!d||n.length===0?null:e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-10",children:n.map(j=>e.jsx("div",{className:"absolute",style:j.style},j.id))})},dt=({type:d,active:s})=>s?e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(25)].map((n,m)=>e.jsx("div",{className:`absolute w-3 h-3 rounded-full ${d==="success"?"bg-emerald-400":"bg-rose-400"}`,style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",animation:`particle-${d} 1.2s ease-out forwards`,animationDelay:`${m*.04}s`,opacity:0}},m)),e.jsx("style",{children:`
        @keyframes particle-success {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*120-60}px), 
              calc(-50% + ${Math.random()*120-60}px)
            ) scale(1.8) rotate(${Math.random()*360}deg); 
          }
        }
        @keyframes particle-fail {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*100-50}px), 
              calc(-50% + ${Math.random()*100-50}px)
            ) scale(1.5) rotate(${Math.random()*360}deg); 
          }
        }
      `})]}):null;function Mt(){const{props:d}=qe(),{match:s,challenge:n}=d,[m,j]=o.useState((n==null?void 0:n.buggy_code)??""),[h,b]=o.useState(null),[T,je]=o.useState(!1),[Ne,Q]=o.useState(!1),[G,ke]=o.useState([]),[B,Se]=o.useState(!0),D=o.useRef(null),I=o.useRef(null),X=o.useRef(null),[_,K]=o.useState(null),[p,W]=o.useState(null),Y=o.useRef(!1),R=o.useRef(null),E=o.useMemo(()=>p==null?"muted":p<=1e4?"danger":p<=6e4?"warning":"ok",[p]),Me=t=>{const a=Math.max(0,Math.floor(t/1e3)),l=Math.floor(a/60),i=a%60;return`${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},[ae,ne]=o.useState("idle"),[Ce,Z]=o.useState(!1),[oe,$e]=o.useState(null),[Te,P]=o.useState(!1),[N,_e]=o.useState(null),[c,Re]=o.useState(null),[k,U]=o.useState("think"),ie=()=>{const t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},Ee=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};o.useEffect(()=>(ie(),()=>{Ee()}),[]);const[V,J]=o.useState(null);o.useEffect(()=>{let t=!1;return(async()=>{if(!(c!=null&&c.avatar_url)){J(null);return}const a=S(c.avatar_url,"think");a&&await A(a)&&!t&&J(a);const l=S(c.avatar_url,"sad");l&&A(l);const i=S(c.avatar_url,"smirk");i&&A(i);const u=S(c.avatar_url,"base");u&&A(u)})(),()=>{t=!0}},[c==null?void 0:c.avatar_url]),o.useEffect(()=>{let t=!1;return(async()=>{if(!(c!=null&&c.avatar_url))return;const a=await ct(c.avatar_url,k==="idle"?"think":k,V);!t&&a&&a!==V&&J(a)})(),()=>{t=!0}},[k,c==null?void 0:c.avatar_url]),o.useEffect(()=>(document.body.classList.add("hide-app-header"),()=>document.body.classList.remove("hide-app-header")),[]);const ze=(n==null?void 0:n.title)??"Fix the Bug",Le=(n==null?void 0:n.description)??"Repair the function to satisfy all tests.",Fe=ye((n==null?void 0:n.language)??s.language??""),Oe=((n==null?void 0:n.difficulty)??s.difficulty??"").toUpperCase(),Ae=Array.isArray(n==null?void 0:n.tests)?n.tests.length:0,ee=(n==null?void 0:n.corrected_code)??(n==null?void 0:n.fixed_code)??null,ce=o.useRef(new Set),le=o.useRef(0),de=o.useRef(null),H=o.useRef(!1),q=o.useRef(!1),g=o.useRef(null),ue=(t,a=0,l=1)=>Math.max(a,Math.min(l,t)),me=(t,a,l)=>{const i=t.volume,u=ue(a),r=Math.max(1,l),z=performance.now(),$=L=>{const M=ue((L-z)/r);t.volume=i+(u-i)*M,M<1?requestAnimationFrame($):u===0&&(t.pause(),t.currentTime=0)};requestAnimationFrame($)};o.useEffect(()=>{var a,l,i;const t=u=>{const r=new Audio(u);return r.preload="auto",r.crossOrigin="anonymous",r};try{D.current=t("/sounds/tick.wav"),D.current.volume=.9}catch{}try{I.current=t("/sounds/correct.mp3"),I.current.volume=.95}catch{}try{X.current=t("/sounds/defeat.wav"),X.current.volume=.95}catch{}try{g.current||(g.current=t("/audio/bgm.mp3"),g.current.loop=!0,g.current.volume=0)}catch{}return B?g.current&&(g.current.play().catch(()=>{}),setTimeout(()=>{g.current&&me(g.current,.22,600)},60)):((a=D.current)==null||a.pause(),(l=I.current)==null||l.pause(),(i=X.current)==null||i.pause(),g.current&&me(g.current,0,250)),()=>{var u;(u=g.current)==null||u.pause()}},[B]),o.useEffect(()=>{const t=()=>{ie();const a=[D.current,I.current,X.current,g.current].filter(Boolean);for(const l of a)try{const i=l.play();i&&typeof i.then=="function"&&i.then(()=>{l.pause(),l.currentTime=0}).catch(()=>{})}catch{}window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)};return window.addEventListener("pointerdown",t,{once:!0}),window.addEventListener("keydown",t,{once:!0}),()=>{window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)}},[]);const C=t=>{var l;if(!B)return;const a=t==="tick"?D.current:t==="success"?I.current:X.current;if(a)try{a.currentTime=0,(l=a.play)==null||l.call(a)}catch{}};o.useEffect(()=>{if(_!=null)return;const a=(s.difficulty||"").toLowerCase(),i=(a==="hard"?20:a==="medium"?15:10)*60*1e3;R.current=i,Y.current=!1;const u=Date.now();K(u+i),W(i)},[s.difficulty,_]),o.useEffect(()=>{const t=setInterval(()=>{if(_==null)return;const a=Date.now(),l=Math.max(0,_-a);W(l),l<=1e4&&!Y.current&&(Y.current=!0,C("tick")),l===0&&!q.current&&(q.current=!0,F.post(`/api/match/${s.id}/timeout`).catch(()=>{}),O.fire({title:"Time's up!",text:"This match ended with no rewards.",icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back",confirmButtonColor:"#64748b"}).then(()=>window.location.href="/play/matchmaking"))},250);return()=>clearInterval(t)},[_]);const Be=o.useMemo(()=>p==null?"—:—":Me(p),[p]),De=t=>{const a=t.id??t.submission_id??`${t.user_id}-${t.at??t.created_at??t.timestamp??""}`,l=String(a),i=t.is_correct??t.correct??0,u=typeof i=="boolean"?i:Number(i)===1,r=t.at??t.created_at??t.timestamp??new Date().toISOString(),z=new Date(r),$=Number.isNaN(z.getTime())?Date.now():z.getTime(),L=typeof t.by_me=="boolean"?t.by_me:typeof t.byMe=="boolean"?t.byMe:Number(t.user_id)===Number(s.me);return{id:l,byMe:L,correct:u,text:L?u?"You submitted: Correct!":"You submitted: Wrong.":u?"Opponent submitted: Correct!":"Opponent submitted: Wrong.",ts:$}},pe=t=>t==="hard"?6:t==="medium"?4:3,fe=async t=>{var a,l,i;try{const u=await F.get(`/api/match/${t}/status`),r=(u==null?void 0:u.data)??u;if(r!=null&&r.opponent&&Re({id:Number(r.opponent.id),name:r.opponent.name,avatar_url:r.opponent.avatar_url}),r!=null&&r.ends_at){const f=r!=null&&r.server_now?new Date(r.server_now).getTime():Date.now(),w=new Date(r.ends_at).getTime(),y=Math.max(0,w-f);R.current=y,Y.current=!1,K(Date.now()+y),W(y)}else if(typeof(r==null?void 0:r.remaining_seconds)=="number"){const f=Math.max(0,r.remaining_seconds*1e3);R.current=f,Y.current=!1,K(Date.now()+f),W(f)}const z=Array.isArray(r==null?void 0:r.submissions)&&r.submissions.length>0?Math.max(...r.submissions.map(f=>{const w=f.at??f.created_at??f.timestamp??null,y=w?new Date(w).getTime():0;return Number.isFinite(y)?y:0})):0,$=((a=r==null?void 0:r.last)==null?void 0:a.at)??((l=r==null?void 0:r.last)==null?void 0:l.created_at)??null,L=$?new Date($).getTime():0,M=Math.max(z,L);if(M&&M<le.current)return;if(Array.isArray(r==null?void 0:r.submissions)){const f=r.submissions.map(De).sort((x,v)=>x.ts-v.ts),w=[];for(const x of f)if(!ce.current.has(x.id)&&(ce.current.add(x.id),w.push(x),!x.byMe)){const v=!!x.correct;ne(v?"correct":"wrong"),$e(v?"success":"fail"),Z(!0),_e({text:v?"Correct Solution!":"Wrong Solution",correct:v,time:new Date(x.ts).toLocaleTimeString()}),v?(U("smirk"),C("success"),Ie(),setTimeout(()=>U("base"),1200),setTimeout(()=>Z(!1),1600)):(U("sad"),C("fail"),setTimeout(()=>U("think"),1200),setTimeout(()=>Z(!1),1500)),setTimeout(()=>ne("idle"),2e3)}w.length>0&&ke(x=>{const v=[...x,...w];return v.slice(Math.max(0,v.length-40))});const y=[...f].filter(x=>!x.byMe).sort((x,v)=>v.ts-x.ts)[0];y&&y.id!==de.current&&(de.current=y.id,O.fire({icon:y.correct?"success":"info",title:"Opponent Submitted!",text:y.correct?"They got it right!":"Their solution needs work.",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#1f2937",color:"#fff"}))}if(!q.current){if(r!=null&&r.finished)if(q.current=!0,Number(r==null?void 0:r.winner_user_id)===Number(s.me)){if(C("success"),!H.current){H.current=!0;try{await F.post(`/api/match/${s.id}/award`,{language:s.language,difficulty:s.difficulty})}catch{}}const w=pe(s.difficulty);P(!0),await O.fire({title:"You win! 🎉",html:`<div class="text-zinc-300 text-sm">Great job — your solution passed the tests first.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${w} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}else C("fail"),P(!0),setTimeout(()=>P(!1),4e3),await O.fire({title:"Opponent won",html:`<div class="text-zinc-300 text-sm">They solved it first — good try!<br/>
                     <div class="mt-2 font-semibold text-rose-300">-1 ⭐</div></div>`,icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back to queue",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else if((i=r==null?void 0:r.last)!=null&&i.message&&String(r.last.message).toLowerCase()==="surrendered")if(q.current=!0,Number(r.last.user_id)===Number(s.me))await O.fire({title:"You surrendered",icon:"warning",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"OK",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else{if(C("success"),!H.current){H.current=!0;try{await F.post(`/api/match/${s.id}/award`,{})}catch{}}const w=pe(s.difficulty);P(!0),await O.fire({title:"Opponent surrendered 🏆",html:`<div class="text-zinc-300 text-sm">Victory by surrender.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${w} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}}M&&(le.current=M)}catch(u){console.error("Error fetching match status:",u)}},Ie=()=>{const t=document.querySelector(".opp-avatar-wrap");t&&(t.classList.remove("avatar-ripple"),t.offsetWidth,t.classList.add("avatar-ripple"),setTimeout(()=>t.classList.remove("avatar-ripple"),900))};o.useEffect(()=>{let t=!0;fe(s.id);const a=setInterval(()=>{t&&fe(s.id)},1300);return()=>{t=!1,clearInterval(a)}},[s.id,s.me]);const Xe=async()=>{var t,a,l;try{const{data:i}=await F.post(`/api/match/${s.id}/submit`,{code:m});i!=null&&i.correct?b({type:"success",text:"✅ Correct! Finalizing…"}):(C("tick"),b({type:"error",text:"❌ Wrong — keep trying!"}))}catch(i){console.error("[SUBMIT ERROR]",((t=i==null?void 0:i.response)==null?void 0:t.data)||i),b({type:"error",text:((l=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:l.message)||"Submit failed."})}},[te,xe]=o.useState(!1),Ye=async()=>{var t,a;if(!te){xe(!0);try{await F.post(`/api/match/${s.id}/surrender`,{}),b({type:"error",text:"You surrendered."})}catch(l){b({type:"error",text:((a=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to surrender."})}finally{xe(!1)}}};return[...G].filter(t=>!t.byMe).sort((t,a)=>a.ts-t.ts)[0],e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:[e.jsx("style",{children:`
        .hide-app-header #app-header,
        .hide-app-header .app-header,
        .hide-app-header header[role="banner"] { display: none !important; }
      `}),e.jsxs(Pe,{breadcrumbs:[{title:"Home",href:"/dashboard"},{title:"Match",href:`/play/m/${s.id}`}],children:[e.jsx(We,{title:`Match ${s.id}`}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6",children:[e.jsx(lt,{active:Te,type:"win"}),e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-indigo-400 via-fuchsia-400 to-cyan-400 bg-clip-text text-transparent",children:["1v1 Duel — ",ye(s.language)," / ",s.difficulty.toUpperCase()]}),e.jsx("span",{className:"text-zinc-400 text-sm hidden md:inline",children:"Both players received the same AI-generated challenge."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:["inline-flex items-center gap-2 rounded-lg px-3 py-1.5 border text-zinc-300",E==="ok"?"border-slate-700/60":"",E==="warning"?"border-amber-500/60 bg-amber-500/10":"",E==="danger"?"border-rose-500/60 bg-rose-500/10 animate-pulse":"",E==="muted"?"border-slate-700/60 opacity-70":""].join(" "),title:"Match timer",children:[e.jsx(Qe,{className:["w-4 h-4",E==="danger"?"text-rose-400":E==="warning"?"text-amber-400":"text-cyan-400"].join(" ")}),e.jsx("span",{className:"tabular-nums",children:Be})]}),_&&p!=null&&e.jsx("div",{className:"w-40 h-1.5 bg-slate-800/60 rounded-full overflow-hidden ml-3",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-[width] duration-300",style:{width:R.current&&p!=null&&R.current>0?`${Math.max(0,Math.min(100,p/R.current*100))}%`:"0%"}})}),e.jsxs("button",{onClick:()=>Se(t=>!t),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",title:"Toggle sounds",children:[B?e.jsx(Ue,{className:"w-4 h-4"}):e.jsx(Ve,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:B?"SFX on":"SFX off"})]}),e.jsxs("button",{onClick:()=>Q(!0),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Live feed"})]}),e.jsx("button",{onClick:Ye,disabled:te||p!=null&&p<=0,className:"text-sm px-3 py-2 rounded-lg border border-slate-700/60 disabled:opacity-50 hover:bg-rose-900/20 transition-colors",children:te?"Surrendering…":"Surrender"}),e.jsxs("div",{className:"ml-2 hidden md:flex items-center gap-3 text-zinc-300",children:[e.jsx(he,{className:"w-5 h-5"}),e.jsxs("span",{children:["you #",s.me]}),e.jsx("span",{className:"opacity-40",children:"vs"}),e.jsx(he,{className:"w-5 h-5"}),e.jsxs("span",{children:["opponent #",s.opponent]})]})]})]}),h&&e.jsxs("div",{className:`mb-4 flex items-center gap-2 px-4 py-2 rounded-lg ${h.type==="success"?"bg-green-900/40 text-green-300":"bg-red-900/40 text-red-300"} animate-bounceIn`,children:[h.type==="success"?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:h.text})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-cyan-400"}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:ze})]}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:Le})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"Your Code"}),e.jsx("textarea",{value:m,onChange:t=>j(t.target.value),className:"w-full h-[380px] md:h-[520px] rounded-lg bg-slate-950 border border-slate-700/60 p-3 text-sm text-zinc-100 font-mono focus:border-cyan-500/50 focus:ring-1 focus:ring-cyan-500/30 transition-colors",spellCheck:!1}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-zinc-500 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-3 h-3"})," ",Ae," Tests",e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Ze,{className:"w-3 h-3"})," ",Fe,e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Je,{className:"w-3 h-3"})," ",Oe]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Xe,disabled:p!=null&&p<=0,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-cyan-500 to-indigo-600 text-white font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-95 hover:shadow-lg hover:shadow-cyan-500/20",children:"Submit Solution"}),ee&&e.jsxs("button",{onClick:()=>je(!T),className:"px-3 py-2 rounded-lg border border-slate-700/60 text-xs flex items-center gap-1 hover:bg-slate-800/40 transition-colors",children:[e.jsx(et,{className:"w-4 h-4"}),T?"Hide Solution":"FOR DEMO ONLY"]})]})]}),T&&ee&&e.jsx("pre",{className:`mt-3 p-3 rounded-lg bg-black/40 text-green-300 text-xs
                              overflow-auto max-h-[70vh] whitespace-pre border border-emerald-500/20`,style:{fontFamily:'"Courier New", ui-monospace, SFMono-Regular, Menlo, monospace'},children:ee})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"w-4 h-4 text-amber-300"}),ae!=="idle"&&e.jsx("span",{className:`absolute -top-1 -right-1 w-2 h-2 rounded-full ${ae==="correct"?"bg-emerald-400 animate-ping":"bg-rose-400 animate-ping"}`})]}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:"Opponent Activity"}),e.jsxs("span",{className:"ml-auto text-xs text-zinc-500 flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"})," Live"]})]}),e.jsxs("div",{className:"p-4 h-[460px] md:h-[560px] flex items-center justify-center relative",children:[oe&&e.jsx(dt,{type:oe,active:Ce}),e.jsx("div",{className:"opp-avatar-wrap absolute",children:e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-full border-2 border-transparent"})}),N?e.jsxs("div",{className:"text-center space-y-6 w-full",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:`absolute inset-0 rounded-full ${N.correct?"border-4 border-emerald-500/30 bg-emerald-900/10 animate-ping-slow":"border-4 border-rose-500/30 bg-rose-900/10 animate-pulse"}`}),e.jsx("div",{className:"absolute inset-4 rounded-full border-2 border-slate-700/60"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c!=null&&c.avatar_url?e.jsx("img",{src:V||S(c.avatar_url,"base")||(c==null?void 0:c.avatar_url)||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-40 h-40 object-contain select-none
                                ${k==="think"?"animate-opp-breathe":""}
                                ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                                ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):N.correct?e.jsx(tt,{className:"w-12 h-12 text-yellow-300 animate-bounce"}):e.jsx(se,{className:"w-12 h-12 text-rose-300 animate-pulse"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full ${N.correct?"bg-emerald-900/40 text-emerald-300 border border-emerald-500/40":"bg-rose-900/40 text-rose-300 border border-rose-500/40"} animate-bounceIn`,children:[N.correct?e.jsx(ge,{className:"w-5 h-5"}):e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:N.text})]}),e.jsxs("div",{className:"text-xs text-zinc-400 flex items-center justify-center gap-2",children:[e.jsx(be,{className:"w-3 h-3"}),N.time]})]}),e.jsx("div",{className:"w-full max-w-xs mx-auto bg-slate-800/50 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-1000 ${N.correct?"bg-emerald-500":"bg-rose-500"}`,style:{width:N.correct?"100%":"65%"}})})]}):e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-indigo-500/20 animate-ping-slow"}),e.jsx("div",{className:"absolute inset-3 rounded-full border-2 border-indigo-500/10 animate-pulse-slow"}),c!=null&&c.avatar_url?e.jsx("img",{src:V||S(c.avatar_url,"base")||(c==null?void 0:c.avatar_url)||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-44 h-44 object-contain select-none
                              ${k==="think"?"animate-opp-breathe":""}
                              ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                              ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):e.jsx("div",{className:"w-44 h-44 rounded-full bg-indigo-600/20 grid place-items-center border-2 border-slate-700/60",children:e.jsx(He,{className:"w-12 h-12 text-indigo-300 animate-bounce-slow"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-zinc-200",children:c!=null&&c.name?`${c.name}'s turn…`:"Waiting for opponent"}),e.jsx("p",{className:"text-sm text-zinc-400 max-w-xs mx-auto",children:"Your opponent hasn’t made a submission yet. Stay focused on your solution!"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-700/60",children:e.jsxs("p",{className:"text-xs text-zinc-400 text-center",children:["The panel updates in real-time when your opponent submits a solution.",N&&N.correct&&e.jsx("span",{className:"block mt-1 text-emerald-300 font-medium",children:"They solved it correctly! Hurry up!"})]})})]})]})]})]}),Ne&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end md:items-center md:justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>Q(!1)}),e.jsxs("div",{className:"relative w-full md:w-[640px] max-h-[80vh] overflow-hidden rounded-t-2xl md:rounded-2xl border border-slate-700/60 bg-slate-900/90 backdrop-blur",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center justify-between",children:[e.jsxs("div",{className:"text-zinc-200 font-medium flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-cyan-400"}),"Live attempts"]}),e.jsx("button",{onClick:()=>Q(!1),className:"px-3 py-1.5 rounded-lg text-sm border border-slate-700/60",children:"Close"})]}),e.jsx("div",{className:"p-4 max-h-[65vh] overflow-y-auto",children:G.length===0?e.jsx("div",{className:"text-xs text-zinc-500",children:"No attempts yet."}):e.jsx("ul",{className:"space-y-1",children:[...G].sort((t,a)=>a.ts-t.ts).map(t=>e.jsxs("li",{className:"text-xs",children:[e.jsx("span",{className:t.correct?"text-green-300":"text-red-300",children:t.correct?"✔":"✖"})," ",t.text," ",e.jsxs("span",{className:"opacity-50",children:["(",new Date(t.ts).toLocaleTimeString(),")"]})]},t.id))})})]})]}),e.jsx("style",{children:`
        @keyframes bounceIn {
          0% { transform: scale(0.8); opacity: 0; }
          50% { transform: scale(1.1); }
          100% { transform: scale(1); opacity: 1; }
        }
        .animate-bounceIn { animation: bounceIn 0.5s ease-out; }
        
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin-slow { animation: spin-slow 3s linear infinite; }
        
        @keyframes ping-slow { 0% { transform: scale(1); opacity: 1; } 75%, 100% { transform: scale(2); opacity: 0; } }
        .animate-ping-slow { animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite; }
        
        @keyframes pulse-slow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* Avatar motions */
        @keyframes opp-breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.04); } }
        .animate-opp-breathe { animation: opp-breathe 3.2s ease-in-out infinite; }

        @keyframes opp-shake {
          0%, 100% { transform: translateX(0); }
          15% { transform: translateX(-10px) rotate(-1deg); }
          30% { transform: translateX(10px) rotate(1deg); }
          45% { transform: translateX(-6px) rotate(-1deg); }
          60% { transform: translateX(6px) rotate(1deg); }
          75% { transform: translateX(-3px) rotate(-1deg); }
        }
        .animate-opp-shake { animation: opp-shake 0.8s ease-in-out; }

        @keyframes opp-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-14px) scale(1.02); } }
        .animate-opp-bounce { animation: opp-bounce 0.8s ease-in-out; }

        /* Glow halos */
        .avatar-glow-green { box-shadow: 0 0 0 0 rgba(16,185,129,0.45); animation: glow-green 1.2s ease-out; border-radius: 16px; }
        .avatar-glow-red { box-shadow: 0 0 0 0 rgba(244,63,94,0.45); animation: glow-red 1.0s ease-out; border-radius: 16px; }
        @keyframes glow-green { 0%{ box-shadow: 0 0 0 0 rgba(16,185,129,0.55);} 100%{ box-shadow: 0 0 40px 10px rgba(16,185,129,0);} }
        @keyframes glow-red { 0%{ box-shadow: 0 0 0 0 rgba(244,63,94,0.55);} 100%{ box-shadow: 0 0 36px 8px rgba(244,63,94,0);} }

        /* Shockwave ripple (correct) */
        .avatar-ripple::after {
          content: '';
          position: absolute; inset: -8px;
          border: 3px solid rgba(16,185,129,0.45);
          border-radius: 9999px;
          animation: ripple 0.9s ease-out forwards;
        }
        @keyframes ripple { 0%{ transform: scale(0.7); opacity: 1;} 100%{ transform: scale(1.4); opacity: 0;} }

        /* Existing slow bounce for fallback */
        @keyframes bounce-slow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .animate-bounce-slow { animation: bounce-slow 2s ease-in-out infinite; }
      `})]})}export{Mt as default};
