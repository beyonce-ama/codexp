import{r as c,j as e,K as fs,L as Oe}from"./app-i04PncLm.js";import{a as J,A as Fe,T as me}from"./app-layout-3w_DOu0M.js";import{A as gs}from"./AnimatedBackground-BNRBRKIc.js";import{L as Ge}from"./loader-circle-B_drNpcQ.js";import{A as bs}from"./activity-DYwxnk1u.js";import{M as Ye}from"./medal-xAMIuoB8.js";import{S as O,U as js,C as vs}from"./users-Dw55tc71.js";import{Z as Ke}from"./zap-XHJNamwe.js";import{T as W}from"./trophy-BN2pTIo7.js";import{M as Ns,i as ys,u as Qe,P as ws,a as _s,b as ks,L as Cs,m as Ss}from"./proxy-CLSY5ULc.js";import{C as He}from"./circle-check-big-St345zqy.js";import{S as xe,a as As}from"./x-Cw858x9Q.js";import{C as Ps}from"./crown-DFdN3NjP.js";import{C as Ls}from"./cpu-vnNSd2nL.js";import{T as Je}from"./trending-up-Cu7GpCVg.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-BX1znG1t.js";class $s extends c.Component{getSnapshotBeforeUpdate(i){const t=this.props.childRef.current;if(t&&i.isPresent&&!this.props.isPresent){const f=t.offsetParent,b=ys(f)&&f.offsetWidth||0,m=this.props.sizeRef.current;m.height=t.offsetHeight||0,m.width=t.offsetWidth||0,m.top=t.offsetTop,m.left=t.offsetLeft,m.right=b-m.width-m.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Es({children:d,isPresent:i,anchorX:t,root:f}){const b=c.useId(),m=c.useRef(null),C=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:L}=c.useContext(Ns);return c.useInsertionEffect(()=>{const{width:I,height:h,top:A,left:p,right:x}=C.current;if(i||!m.current||!I||!h)return;const N=t==="left"?`left: ${p}`:`right: ${x}`;m.current.dataset.motionPopId=b;const j=document.createElement("style");L&&(j.nonce=L);const y=f??document.head;return y.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${b}"] {
            position: absolute !important;
            width: ${I}px !important;
            height: ${h}px !important;
            ${N}px !important;
            top: ${A}px !important;
          }
        `),()=>{y.contains(j)&&y.removeChild(j)}},[i]),e.jsx($s,{isPresent:i,childRef:m,sizeRef:C,children:c.cloneElement(d,{ref:m})})}const Ms=({children:d,initial:i,isPresent:t,onExitComplete:f,custom:b,presenceAffectsLayout:m,mode:C,anchorX:L,root:I})=>{const h=Qe(Ts),A=c.useId();let p=!0,x=c.useMemo(()=>(p=!1,{id:A,initial:i,isPresent:t,custom:b,onExitComplete:N=>{h.set(N,!0);for(const j of h.values())if(!j)return;f&&f()},register:N=>(h.set(N,!1),()=>h.delete(N))}),[t,h,f]);return m&&p&&(x={...x}),c.useMemo(()=>{h.forEach((N,j)=>h.set(j,!1))},[t]),c.useEffect(()=>{!t&&!h.size&&f&&f()},[t]),C==="popLayout"&&(d=e.jsx(Es,{isPresent:t,anchorX:L,root:I,children:d})),e.jsx(ws.Provider,{value:x,children:d})};function Ts(){return new Map}const ae=d=>d.key||"";function Ze(d){const i=[];return c.Children.forEach(d,t=>{c.isValidElement(t)&&i.push(t)}),i}const Ws=({children:d,custom:i,initial:t=!0,onExitComplete:f,presenceAffectsLayout:b=!0,mode:m="sync",propagate:C=!1,anchorX:L="left",root:I})=>{const[h,A]=_s(C),p=c.useMemo(()=>Ze(d),[d]),x=C&&!h?[]:p.map(ae),N=c.useRef(!0),j=c.useRef(p),y=Qe(()=>new Map),[le,re]=c.useState(p),[$,F]=c.useState(p);ks(()=>{N.current=!1,j.current=p;for(let w=0;w<$.length;w++){const u=ae($[w]);x.includes(u)?y.delete(u):y.get(u)!==!0&&y.set(u,!1)}},[$,x.length,x.join("-")]);const B=[];if(p!==le){let w=[...p];for(let u=0;u<$.length;u++){const E=$[u],D=ae(E);x.includes(D)||(w.splice(u,0,E),B.push(E))}return m==="wait"&&B.length&&(w=B),F(Ze(w)),re(p),null}const{forceRender:G}=c.useContext(Cs);return e.jsx(e.Fragment,{children:$.map(w=>{const u=ae(w),E=C&&!h?!1:p===$||x.includes(u),D=()=>{if(y.has(u))y.set(u,!0);else return;let z=!0;y.forEach(Y=>{Y||(z=!1)}),z&&(G==null||G(),F(j.current),C&&(A==null||A()),f&&f())};return e.jsx(Ms,{isPresent:E,initial:!N.current||t?void 0:!1,custom:i,presenceAffectsLayout:b,mode:m,root:I,onExitComplete:E?void 0:D,anchorX:L,children:w},u)})})},qe=[{title:"Home",href:"/dashboard"},{title:"Dashboard",href:"/dashboard"}],Is=d=>Math.floor(d/10)+1,es=d=>d%10,Ds=d=>es(d)/10*100;function st(){var je,ve,Ne,ye,we,_e,ke,Ce,Se,Ae,Pe,Le,$e,Ee,Me,Te,We,Ie,De,Re,Ve,Xe,Be,ze;const{auth:d}=fs().props,i=d==null?void 0:d.user,[t,f]=c.useState(null),[b,m]=c.useState([]),[C,L]=c.useState(!0),[I,h]=c.useState(!1),[A,p]=c.useState(null),[x,N]=c.useState([]),[j,y]=c.useState(0),[le,re]=c.useState("Current Season"),$=s=>{switch(s){case"Solo":return"bg-blue-900/30 border-blue-800 text-blue-300";case"Solo+AI":return"bg-indigo-900/30 border-indigo-800 text-indigo-300";case"Invite Duel":return"bg-rose-900/30 border-rose-800 text-rose-300";case"Live Match":return"bg-amber-900/30 border-amber-800 text-amber-300";case"Python":return"bg-emerald-900/30 border-emerald-800 text-emerald-300";case"Java":return"bg-orange-900/30 border-orange-800 text-orange-300";case"C++":return"bg-blue-900/30 border-blue-800 text-blue-300";default:return"bg-slate-900/30 border-slate-700 text-slate-300"}},F=s=>{if(!s)return null;const l=String(s).trim();return/^(https?:\/\/|data:)/i.test(l)||l.startsWith("/")?l:l.startsWith("avatars/")||l.startsWith("storage/")?`/${l}`:`/avatars/${l}`},B=s=>s?s.startsWith("SOLO_AI_")?"Solo+AI":s.startsWith("SOLO_")?"Solo":s.startsWith("PVP_INVITE_")?"Invite Duel":s.startsWith("PVP_LIVE_")?"Live Match":s.startsWith("LANG_PY_")?"Python":s.startsWith("LANG_JAVA_")?"Java":s.startsWith("LANG_CPP_")?"C++":"General":"General",G=s=>s&&typeof s=="object"&&("code"in s||"threshold"in s||"xp_reward"in s||"name"in s||"goal"in s),w=s=>{const l=Number(s.threshold??s.goal??0),a=Number(s.current??s.count??0),r=s.progress!=null?Number(s.progress):l>0?Math.min(100,Math.round(a/l*100)):0,n=Number.isFinite(r)?Math.max(0,Math.min(100,r)):0,v=l>0&&a>=l||n>=100,V=!!(s.claimed??s.is_claimed??!1),X=!!(s.unlocked??v),se=!!(s.can_claim??(X&&!V)),P=s.code??s.key??s.name??"",S=s.name??s.title??s.code,g=s.description??s.desc,M=s.icon_key??s.icon,te=s.xp_reward??s.xp,H=s.stars_reward??s.stars,k=s.scope??s.category??s.group;return{id:Number.isFinite(Number(s.id))?Number(s.id):void 0,code:String(P),name:String(S??"Achievement"),description:g??void 0,icon_key:M??null,threshold:l,current:a,progress:n,unlocked:X,claimed:V,can_claim:se,xp_reward:Number(te??0),stars_reward:Number(H??0),__scope:k??B(String(P))}},u=s=>{const l=[],a=n=>{if(!n)return;if(Array.isArray(n)){n.forEach(a);return}if(typeof n!="object")return;if(G(n)){l.push(w(n));return}const v=[n.items,n.achievements,n.tasks,n.groups,n.categories,n.data].filter(Boolean);v.length?v.forEach(a):Object.values(n).forEach(a)};a(s);const r=new Set;return l.filter(n=>{const v=n.id!=null?`id:${n.id}`:`code:${n.code}|scope:${n.__scope??""}`;return r.has(v)?!1:(r.add(v),!0)})};c.useEffect(()=>{E(!0)},[]);const E=async(s=!1)=>{var l,a,r,n,v,V,X,se;try{s&&L(!0);const[P,S,g]=await Promise.all([J.get("/api/me/stats"),J.get("/api/users/participants"),J.get("/api/achievements/progress")]),M=((l=g==null?void 0:g.data)==null?void 0:l.items)??((a=g==null?void 0:g.data)==null?void 0:a.data)??(g==null?void 0:g.data)??g,te=u(M);if(N(te),ns){const H=te.filter(k=>k.can_claim);for(const k of H)try{const o=await J.post("/api/achievements/claim",{achievement_id:k.id}),T=((r=o==null?void 0:o.data)==null?void 0:r.xp_reward)??k.xp_reward??0,de=((n=o==null?void 0:o.data)==null?void 0:n.stars_reward)??k.stars_reward??0;be({name:k.name,xp:T,stars:de,icon_key:k.icon_key??void 0})}catch(o){console.error("Auto-claim failed",k.id,o)}}if(y(Number((M==null?void 0:M.solo_completed)??(M==null?void 0:M.completed)??((v=g==null?void 0:g.data)==null?void 0:v.solo_completed)??0)),P!=null&&P.success&&P.data&&(f(P.data),p(new Date)),S!=null&&S.success){const H=Array.isArray(S.data)?S.data:Array.isArray((V=S.data)==null?void 0:V.data)?S.data.data:[];(se=(X=S.data)==null?void 0:X.season)!=null&&se.name&&re(S.data.season.name);const k=H.map(o=>{var Ue;const T=Number(o.total_xp??o.season_xp??0),de=Number(o.stars??o.season_stars??0),hs=Number(o.crowns??0),ps=o.last_season_rank??null,us=F(o.avatar??((Ue=o.profile)==null?void 0:Ue.avatar)??null);return{id:o.id,name:o.name,email:o.email,avatar:us,total_xp:T,stars:de,level:Math.floor(T/10)+1,crowns:hs,last_season_rank:ps}}).sort((o,T)=>T.total_xp-o.total_xp||T.stars-o.stars).map((o,T)=>({...o,rank:T+1}));m(k)}}catch(P){console.error("Error fetching dashboard/leaderboard:",P)}finally{L(!1),h(!1)}},D=((je=t==null?void 0:t.user)==null?void 0:je.stars)??((ve=t==null?void 0:t.totals)==null?void 0:ve.stars)??0,z=(Ne=t==null?void 0:t.solo_stats)!=null&&Ne.total_attempts?Math.round(t.solo_stats.successful_attempts/t.solo_stats.total_attempts*100):0,Y=(ye=t==null?void 0:t.ai_stats)!=null&&ye.ai_attempts?Math.round(t.ai_stats.ai_successful_attempts/t.ai_stats.ai_attempts*100):0,he=(((we=t==null?void 0:t.solo_stats)==null?void 0:we.total_attempts)||0)+(((_e=t==null?void 0:t.ai_stats)==null?void 0:_e.ai_attempts)||0),pe=(((ke=t==null?void 0:t.solo_stats)==null?void 0:ke.successful_attempts)||0)+(((Ce=t==null?void 0:t.ai_stats)==null?void 0:Ce.ai_successful_attempts)||0),Z=he>0?Math.round(pe/he*100):0,ss=(t==null?void 0:t.duels_played)??0,ts=(t==null?void 0:t.duels_won)??0,as=(t==null?void 0:t.live_played)??(t==null?void 0:t.matches_played)??0,ls=(t==null?void 0:t.live_won)??(t==null?void 0:t.matches_won)??0,q=ss+as,ne=ts+ls,rs=q?Math.round(ne/q*100):0,ie=b.find(s=>s.id===(i==null?void 0:i.id)),K=(ie==null?void 0:ie.rank)??null,[ue,fe]=c.useState(null),ns=!0,[is,Q]=c.useState(!1),ce=c.useRef(null);c.useEffect(()=>{const s=a=>{ce.current&&(ce.current.contains(a.target)||Q(!1))},l=a=>{a.key==="Escape"&&Q(!1)};return document.addEventListener("mousedown",s),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",l)}},[]);const[cs,ge]=c.useState([]),be=s=>{const l=`${Date.now()}-${Math.random().toString(36).slice(2)}`;ge(a=>[...a,{id:l,...s}]),setTimeout(()=>ge(a=>a.filter(r=>r.id!==l)),3500)},os=async s=>{var l,a;try{fe(s);const r=x.find(X=>X.id===s),n=await J.post("/api/achievements/claim",{achievement_id:s}),v=((l=n==null?void 0:n.data)==null?void 0:l.xp_reward)??(r==null?void 0:r.xp_reward)??0,V=((a=n==null?void 0:n.data)==null?void 0:a.stars_reward)??(r==null?void 0:r.stars_reward)??0;be({name:(r==null?void 0:r.name)||"Achievement",xp:v,stars:V,icon_key:(r==null?void 0:r.icon_key)??void 0}),await E(!1)}catch(r){console.error("Claim failed",r)}finally{fe(null)}},ee=Is(((Se=t==null?void 0:t.totals)==null?void 0:Se.xp)||0),oe=es(((Ae=t==null?void 0:t.totals)==null?void 0:Ae.xp)||0),ds=Ds(((Pe=t==null?void 0:t.totals)==null?void 0:Pe.xp)||0),ms=s=>s===1?{label:"Gold",className:"text-yellow-400",chip:"bg-yellow-500/15 border-yellow-700"}:s===2?{label:"Silver",className:"text-slate-200",chip:"bg-slate-400/10 border-slate-500"}:s===3?{label:"Bronze",className:"text-amber-500",chip:"bg-amber-500/10 border-amber-600"}:{label:"",className:"text-slate-300",chip:"bg-slate-800 border-slate-700"},U=({title:s,right:l,children:a,className:r=""})=>e.jsxs("section",{className:`bg-slate-800/50 border border-slate-700 rounded-2xl p-5 ${r}`,children:[e.jsxs("header",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-semibold tracking-wide",children:s}),l]}),a]}),R=({icon:s,label:l,value:a})=>e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900/60 border border-slate-700 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-800 border border-slate-700",children:e.jsx(s,{className:"h-5 w-5 text-cyan-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:l}),e.jsx("p",{className:"text-base font-semibold text-white",children:a})]})]}),xs=({value:s})=>e.jsx("div",{className:"w-full h-3 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-cyan-500 via-blue-500 to-fuchsia-500",style:{width:`${s}%`}})}),_=({title:s,value:l,icon:a,description:r,tone:n="slate"})=>{const v={slate:"bg-slate-900/60 border-slate-700 text-slate-200",green:"bg-emerald-900/30 border-emerald-800 text-emerald-300",indigo:"bg-indigo-900/30 border-indigo-800 text-indigo-300",amber:"bg-amber-900/30 border-amber-800 text-amber-300",rose:"bg-rose-900/30 border-rose-800 text-rose-300",purple:"bg-purple-900/30 border-purple-800 text-purple-300",cyan:"bg-cyan-900/30 border-cyan-800 text-cyan-300",blue:"bg-blue-900/30 border-blue-800 text-blue-300",yellow:"bg-yellow-900/30 border-yellow-800 text-yellow-300",red:"bg-red-900/30 border-red-800 text-red-300"};return e.jsx("div",{className:`rounded-xl border p-4 ${v[n]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:l}),r&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:r})]})]})})};return C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:e.jsxs(Fe,{breadcrumbs:qe,children:[e.jsx(Oe,{title:"Dashboard"}),e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ge,{className:"h-8 w-8 animate-spin mx-auto mb-3 text-cyan-400"}),e.jsx("div",{className:"text-slate-300",children:"Loading your dashboard…"})]})})]})}):e.jsxs("div",{className:"min-h-screen relative overflow-x-hidden scroll-smooth",children:[e.jsx("div",{className:"pointer-events-none fixed inset-0 -z-10","aria-hidden":"true",children:e.jsx(gs,{})}),e.jsxs(Fe,{breadcrumbs:qe,children:[e.jsx(Oe,{title:"Dashboard"}),e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(bs,{className:"h-7 w-7 text-cyan-400"}),e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:["Welcome back, ",i==null?void 0:i.name,"!"]})]}),e.jsxs("p",{className:"text-slate-400",children:["Ready for your next coding challenge?",A&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• Updated ",A.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[K!=null&&e.jsx(R,{icon:Ye,label:"Rank",value:`#${K}`}),e.jsx(R,{icon:O,label:"Stars",value:D}),e.jsx(R,{icon:Ke,label:"Total XP",value:((Le=t==null?void 0:t.totals)==null?void 0:Le.xp)??0}),e.jsxs("div",{ref:ce,className:"relative",children:[e.jsxs("button",{onClick:()=>Q(s=>!s),className:"inline-flex items-center gap-2 rounded-xl px-4 py-2 bg-slate-800 border border-slate-700 text-white hover:bg-slate-700",title:"View Achievements",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{children:"Achievements"})]}),e.jsx(Ws,{children:is&&e.jsx(Ss.div,{initial:{opacity:0,y:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-6,scale:.98},transition:{type:"spring",stiffness:380,damping:28,mass:.6},className:"absolute right-0 mt-2 w-[28rem] max-w-[90vw] z-[60]",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-900/95 shadow-2xl backdrop-blur p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("h3",{className:"text-white font-semibold tracking-wide text-sm",children:"Achievements"})]}),e.jsx("button",{onClick:()=>Q(!1),className:"inline-flex items-center justify-center rounded-lg border border-slate-600 text-slate-200 hover:bg-slate-800 w-7 h-7",title:"Close",children:"✕"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"My Trophies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.filter(s=>s.claimed).length===0?e.jsx("span",{className:"text-slate-500 text-xs",children:"No trophies yet."}):x.filter(s=>s.claimed).slice(0,12).map(s=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-700 bg-slate-900/60 px-2 py-1",children:[s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,alt:s.icon_key||"trophy",className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-[11px] text-white truncate max-w-[180px]",title:s.name,children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"Tasks"}),x.filter(s=>!s.claimed).length===0?e.jsx("div",{className:"text-slate-400 text-sm",children:"No tasks available."}):(()=>{const s=a=>a.can_claim?3:a.unlocked?2:a.progress>0?1:0,l=[...x].filter(a=>!a.claimed).sort((a,r)=>{const n=s(r)-s(a);return n!==0?n:r.progress-a.progress});return e.jsx("div",{className:"space-y-2 max-h-[45vh] overflow-y-auto pr-1",children:l.slice(0,8).map(a=>{const r=B(a.code);return e.jsx("div",{className:`rounded-xl border p-3 ${a.unlocked?"bg-yellow-900/10 border-yellow-800":"bg-slate-900/60 border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:a.icon_key?e.jsx("img",{src:`/trophies/${a.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("p",{className:"text-white font-medium truncate",title:a.name,children:a.name}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full border ${$(r)}`,children:r})]}),a.can_claim?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-amber-900/30 border border-amber-800 text-amber-300",children:"Ready to claim"}):a.unlocked?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-yellow-900/20 border border-yellow-800 text-yellow-300",children:"Completed"}):a.progress>0?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-cyan-900/30 border border-cyan-800 text-cyan-300",children:"In progress"}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-slate-800 border border-slate-600 text-slate-300",children:"Locked"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-2 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a.unlocked?"bg-gradient-to-r from-yellow-400 to-amber-500":"bg-gradient-to-r from-cyan-500 to-blue-500"}`,style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mt-1",children:[e.jsxs("span",{children:[Math.min(a.current,a.threshold)," / ",a.threshold]}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-[10px] text-slate-400",children:["Reward: ",e.jsxs("span",{className:"text-white font-medium",children:["+",a.xp_reward," XP"]})," •"," ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",a.stars_reward]})]}),a.can_claim&&e.jsx("button",{onClick:()=>os(a.id),disabled:ue===a.id,className:"text-[11px] inline-flex items-center gap-2 px-2.5 py-1 rounded-lg border border-yellow-700 bg-yellow-500/10 text-yellow-200 hover:bg-yellow-500/20 disabled:opacity-60",children:ue===a.id?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"h-3.5 w-3.5 animate-spin"}),"Claiming…"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3.5 w-3.5"}),"Claim"]})})]})]})]})]})},a.id)})})})()]})]})})})]})]})]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Level & Progress"})]}),right:e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-slate-400",children:"Next Level"}),e.jsxs("div",{className:"font-semibold text-cyan-300",children:[10-oe," XP needed"]})]}),children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white text-lg font-semibold",children:["Level ",ee]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",oe,"/10 XP)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 w-full md:w-auto",children:[e.jsx(R,{icon:me,label:"Attempts",value:((($e=t==null?void 0:t.solo_stats)==null?void 0:$e.total_attempts)||0)+(((Ee=t==null?void 0:t.ai_stats)==null?void 0:Ee.ai_attempts)||0)}),e.jsx(R,{icon:He,label:"Success",value:`${Z}%`}),e.jsx(R,{icon:xe,label:"Duels",value:q}),e.jsx(R,{icon:W,label:"Wins",value:ne})]})]}),e.jsx(xs,{value:Math.round(ds)}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2",children:[e.jsxs("span",{children:["Level ",ee]}),e.jsxs("span",{children:[oe," / 10 XP"]}),e.jsxs("span",{children:["Level ",ee+1]})]})]}),e.jsxs(U,{title:"Your KPIs",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Total XP",value:((Me=t==null?void 0:t.totals)==null?void 0:Me.xp)||0,icon:Ke,tone:"yellow"}),e.jsx(_,{title:"Total Attempts",value:(((Te=t==null?void 0:t.solo_stats)==null?void 0:Te.total_attempts)||0)+(((We=t==null?void 0:t.ai_stats)==null?void 0:We.ai_attempts)||0),icon:me,tone:"blue"}),e.jsx(_,{title:"Solo Attempts",value:((Ie=t==null?void 0:t.solo_stats)==null?void 0:Ie.total_attempts)||0,icon:js,tone:"indigo"}),e.jsx(_,{title:"AI Attempts",value:((De=t==null?void 0:t.ai_stats)==null?void 0:De.ai_attempts)||0,icon:Ls,tone:"cyan"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(_,{title:"Overall Success",value:`${Z}%`,icon:Je,description:`${pe} successful attempts`,tone:Z>70?"green":Z>50?"blue":"amber"}),e.jsx(_,{title:"Solo Success",value:`${z}%`,icon:He,description:`${((Re=t==null?void 0:t.solo_stats)==null?void 0:Re.successful_attempts)||0} successful solo attempts`,tone:z>70?"green":z>50?"blue":"amber"}),e.jsx(_,{title:"AI Success",value:`${Y}%`,icon:As,description:`${((Ve=t==null?void 0:t.ai_stats)==null?void 0:Ve.ai_successful_attempts)||0} successful AI attempts`,tone:Y>70?"green":Y>50?"blue":"amber"})]})]}),e.jsx(U,{title:"Duel Performance",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Stars Earned",value:D,icon:O,description:"Achievement stars",tone:"purple"}),e.jsx(_,{title:"Duels Played",value:q,icon:xe,description:"Total matches (invite + live)",tone:"red"}),e.jsx(_,{title:"Duels Won",value:ne,icon:W,description:"Victories (invite + live)",tone:"green"}),e.jsx(_,{title:"Win Rate",value:`${rs}%`,icon:Je,description:"Success percentage",tone:"indigo"})]})}),e.jsx(U,{title:"Today's Activity",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-blue-900/30 border border-blue-800 mb-2",children:e.jsx(me,{className:"h-6 w-6 text-blue-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((Xe=t==null?void 0:t.solo_stats)==null?void 0:Xe.attempts_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Solo Attempts Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-rose-900/30 border border-rose-800 mb-2",children:e.jsx(xe,{className:"h-6 w-6 text-rose-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(t==null?void 0:t.duels_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Duels Started Today"})]})]})}),(t==null?void 0:t.language_stats)&&t.language_stats.length>0&&e.jsx(U,{title:"Language Proficiency",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols- gap-4",children:t.language_stats.map(s=>e.jsx(_,{title:s.language,value:`${s.winrate}%`,icon:vs,description:`${s.games_played} games played`,tone:s.winrate>70?"green":s.winrate>50?"blue":"amber"},s.id))})})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(U,{title:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Leaderboard"})]}),e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:le})]}),right:e.jsx("span",{className:"text-xs text-slate-400",children:"XP • Stars"}),className:"xl:sticky xl:top-4 xl:self-start",children:[b.slice(0,3).length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:b.slice(0,3).map(s=>{const l=ms(s.rank);return e.jsxs("div",{className:`rounded-xl p-3 border ${l.chip} text-center`,children:[e.jsx("div",{className:"mt-2 mx-auto w-12 h-12 rounded-full overflow-hidden ring-1 ring-slate-700/60",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Ye,{className:`h-5 w-5 ${l.className}`}),e.jsxs("span",{className:`text-sm font-semibold ${l.className}`,children:["#",s.rank]})]}),e.jsx("div",{className:"mt-1 text-white text-sm font-bold truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"text-[11px] text-slate-400",children:["Lvl ",s.level]}),e.jsxs("div",{className:"mt-1 text-xs text-cyan-300",children:[s.total_xp," XP"]})]},s.id)})}),e.jsxs("div",{className:"divide-y divide-slate-700/70 overflow-y-visible no-scrollbar",children:[b.slice(3,15).map(s=>e.jsxs("div",{className:"py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:`text-sm font-bold ${s.rank<=3?"text-yellow-400":"text-slate-300"}`,children:["#",s.rank]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-white font-medium truncate ${s.id===(i==null?void 0:i.id)?"underline decoration-dotted":""}`,title:s.name,children:s.id===(i==null?void 0:i.id)?"You":s.name}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",s.level]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.total_xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id)),b.length===0&&e.jsx("div",{className:"py-8 text-center text-slate-400",children:"No participants yet."})]}),K!=null&&K>15&&e.jsxs("div",{className:"mt-3 rounded-xl border border-cyan-800 bg-cyan-900/20 p-3",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Your Position"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:"text-sm font-bold text-cyan-300",children:["#",K]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:F(((Be=i==null?void 0:i.profile)==null?void 0:Be.avatar)??(i==null?void 0:i.avatar)??null)||"/avatars/default.png",alt:i==null?void 0:i.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium truncate",children:"You"}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",ee]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[((ze=t==null?void 0:t.totals)==null?void 0:ze.xp)??0," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",D]})]})]})]})]})]})})]}),e.jsx("div",{className:"fixed top-4 right-4 z-[60] space-y-2",children:cs.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-yellow-700 bg-slate-900/90 backdrop-blur px-4 py-3 shadow-lg",children:[e.jsx("div",{className:"p-2 rounded-lg border border-yellow-700 bg-yellow-500/10",children:s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm text-white font-semibold truncate",title:s.name,children:["Achievement Unlocked: ",s.name]}),e.jsxs("p",{className:"text-xs text-slate-300",children:["+",s.xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id))})]}),e.jsx("style",{children:`
  .no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `})]})}export{st as default};
