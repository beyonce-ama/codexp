import{K as Xe,r as o,j as e,L as Fe}from"./app-BwFH7jU0.js";import{a as A,A as Ye,V as We,c as Pe,U as xe,C as he,T as Ue}from"./app-layout-1hpVSBFs.js";import{S as O}from"./sweetalert2.esm.all-acGi8jXx.js";import{T as Ve}from"./timer-IwoTgavc.js";import{c as we}from"./createLucideIcon-r6SmsGRr.js";import{C as be}from"./circle-check-big-M3W-m5PK.js";import{C as se}from"./circle-x-0hKd63uR.js";import{B as He}from"./bolt-KaTYKxSF.js";import{C as qe}from"./code-xml-m34F8OHP.js";import{Z as Qe}from"./zap-px6nUWQm.js";import{T as Ge}from"./trophy-CWmpmeQP.js";import{E as Ke}from"./eye-k5_M5ZAW.js";import{C as Ze}from"./crown-BDplVM-Z.js";import"./utils-jAU0Cazi.js";import"./users-BG8Sj33R.js";import"./x-CFex_IkZ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]],et=we("Hourglass",Je);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],ge=we("Radio",tt),ae=d=>d?d.split("?")[0]:null,st=d=>{if(!d)return".png";const s=ae(d).match(/\.(png|jpg|jpeg|webp|gif)$/i);return s?s[0]:".png"},at=d=>d?ae(d).replace(/\.(png|jpg|jpeg|webp|gif)$/i,"").replace(/_(sad|think|smirk)$/i,""):null,rt=d=>{if(!d)return null;let s=ae(d);return/^https?:\/\//i.test(s)||s.startsWith("//")||(s=s.replace(/^\/?public\//i,"/"),s.startsWith("/")||(s="/"+s),s=s.replace(/([^:])\/{2,}/g,"$1/")),s},S=(d,s="think")=>{const n=rt(d);if(!n)return null;const u=at(n);if(!u)return n;const j=st(n),h=s==="base"?"":`_${s}`;return`${`${u}${h}${j}`}?v=${Date.now()}`},B=d=>new Promise(s=>{const n=new Image;n.onload=()=>s(!0),n.onerror=()=>s(!1),n.src=d}),nt=async(d,s,n)=>{const u=s==="base"?["base","think"]:[s,"think","base"];for(const j of u){const h=S(d,j);if(h&&await B(h))return h}return n??await B(S(d,"base"))?S(d,"base"):null},ot=({active:d,type:s="win"})=>{const[n,u]=o.useState([]);return o.useEffect(()=>{if(d){const j=[],h=s==="win"?["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a","#ffb347"]:["#4ade80","#22d3ee","#fbbf24","#f472b6","#a78bfa","#60a5fa"];for(let b=0;b<70;b++)j.push({id:b,style:{left:"50%",top:"50%",backgroundColor:h[Math.floor(Math.random()*h.length)],transform:`rotate(${Math.random()*360}deg)`,opacity:0,width:`${8+Math.random()*8}px`,height:`${8+Math.random()*8}px`,borderRadius:Math.random()>.5?"50%":"0%"}});u(j),setTimeout(()=>{u(b=>b.map(T=>({...T,style:{...T.style,left:`${50+(Math.random()*100-50)}%`,top:`${50+(Math.random()*100-50)}%`,opacity:1,transition:`all ${.8+Math.random()*.7}s ease-out`}})))},10),setTimeout(()=>{u([])},4e3)}},[d,s]),!d||n.length===0?null:e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-10",children:n.map(j=>e.jsx("div",{className:"absolute",style:j.style},j.id))})},it=({type:d,active:s})=>s?e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(25)].map((n,u)=>e.jsx("div",{className:`absolute w-3 h-3 rounded-full ${d==="success"?"bg-emerald-400":"bg-rose-400"}`,style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",animation:`particle-${d} 1.2s ease-out forwards`,animationDelay:`${u*.04}s`,opacity:0}},u)),e.jsx("style",{children:`
        @keyframes particle-success {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*120-60}px), 
              calc(-50% + ${Math.random()*120-60}px)
            ) scale(1.8) rotate(${Math.random()*360}deg); 
          }
        }
        @keyframes particle-fail {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*100-50}px), 
              calc(-50% + ${Math.random()*100-50}px)
            ) scale(1.5) rotate(${Math.random()*360}deg); 
          }
        }
      `})]}):null;function kt(){const{props:d}=Xe(),{match:s,challenge:n}=d,[u,j]=o.useState((n==null?void 0:n.buggy_code)??""),[h,b]=o.useState(null),[T,ye]=o.useState(!1),[ve,Q]=o.useState(!1),[G,je]=o.useState([]),[D,Ne]=o.useState(!0),I=o.useRef(null),X=o.useRef(null),F=o.useRef(null),[_,K]=o.useState(null),[p,P]=o.useState(null),Y=o.useRef(!1),R=o.useRef(null),z=o.useMemo(()=>p==null?"muted":p<=1e4?"danger":p<=6e4?"warning":"ok",[p]),ke=t=>{const r=Math.max(0,Math.floor(t/1e3)),l=Math.floor(r/60),i=r%60;return`${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},[re,ne]=o.useState("idle"),[Se,Z]=o.useState(!1),[oe,Me]=o.useState(null),[$e,U]=o.useState(!1),[N,Ce]=o.useState(null),[c,Te]=o.useState(null),[k,V]=o.useState("think"),[H,J]=o.useState(null);o.useEffect(()=>{let t=!1;return(async()=>{if(!(c!=null&&c.avatar_url)){J(null);return}const r=S(c.avatar_url,"think");r&&await B(r)&&!t&&J(r);const l=S(c.avatar_url,"sad");l&&B(l);const i=S(c.avatar_url,"smirk");i&&B(i);const m=S(c.avatar_url,"base");m&&B(m)})(),()=>{t=!0}},[c==null?void 0:c.avatar_url]),o.useEffect(()=>{let t=!1;return(async()=>{if(!(c!=null&&c.avatar_url))return;const r=await nt(c.avatar_url,k==="idle"?"think":k,H);!t&&r&&r!==H&&J(r)})(),()=>{t=!0}},[k,c==null?void 0:c.avatar_url]),o.useEffect(()=>(document.body.classList.add("hide-app-header"),()=>document.body.classList.remove("hide-app-header")),[]);const _e=(n==null?void 0:n.title)??"Fix the Bug",Re=(n==null?void 0:n.description)??"Repair the function to satisfy all tests.",ze=((n==null?void 0:n.language)??s.language??"").toUpperCase(),Ee=((n==null?void 0:n.difficulty)??s.difficulty??"").toUpperCase(),Le=Array.isArray(n==null?void 0:n.tests)?n.tests.length:0,ee=(n==null?void 0:n.corrected_code)??(n==null?void 0:n.fixed_code)??null,ie=o.useRef(new Set),ce=o.useRef(0),le=o.useRef(null),q=o.useRef(!1),W=o.useRef(!1),g=o.useRef(null),de=(t,r=0,l=1)=>Math.max(r,Math.min(l,t)),me=(t,r,l)=>{const i=t.volume,m=de(r),a=Math.max(1,l),E=performance.now(),C=L=>{const M=de((L-E)/a);t.volume=i+(m-i)*M,M<1?requestAnimationFrame(C):m===0&&(t.pause(),t.currentTime=0)};requestAnimationFrame(C)};o.useEffect(()=>(document.body.classList.add("hide-app-header"),()=>document.body.classList.remove("hide-app-header")),[]),o.useEffect(()=>{var r,l,i;const t=m=>{const a=new Audio(m);return a.preload="auto",a.crossOrigin="anonymous",a};try{I.current=t("/sounds/tick.wav"),I.current.volume=.9}catch{}try{X.current=t("/sounds/correct.mp3"),X.current.volume=.95}catch{}try{F.current=t("/sounds/defeat.wav"),F.current.volume=.95}catch{}try{g.current||(g.current=t("/audio/bgm.mp3"),g.current.loop=!0,g.current.volume=0)}catch{}return D?g.current&&(g.current.play().catch(()=>{}),setTimeout(()=>{g.current&&me(g.current,.22,600)},60)):((r=I.current)==null||r.pause(),(l=X.current)==null||l.pause(),(i=F.current)==null||i.pause(),g.current&&me(g.current,0,250)),()=>{var m;(m=g.current)==null||m.pause()}},[D]),o.useEffect(()=>{const t=()=>{const r=[I.current,X.current,F.current,g.current].filter(Boolean);for(const l of r)try{const i=l.play();i&&typeof i.then=="function"&&i.then(()=>{l.pause(),l.currentTime=0}).catch(()=>{})}catch{}window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)};return window.addEventListener("pointerdown",t,{once:!0}),window.addEventListener("keydown",t,{once:!0}),()=>{window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)}},[]);const $=t=>{var l;if(!D)return;const r=t==="tick"?I.current:t==="success"?X.current:F.current;if(r)try{r.currentTime=0,(l=r.play)==null||l.call(r)}catch{}};o.useEffect(()=>{if(_!=null)return;const r=(s.difficulty||"").toLowerCase(),i=(r==="hard"?20:r==="medium"?15:10)*60*1e3;R.current=i,Y.current=!1;const m=Date.now();K(m+i),P(i)},[s.difficulty,_]),o.useEffect(()=>{const t=setInterval(()=>{if(_==null)return;const r=Date.now(),l=Math.max(0,_-r);P(l),l<=1e4&&!Y.current&&(Y.current=!0,$("tick")),l===0&&!W.current&&(W.current=!0,A.post(`/api/match/${s.id}/timeout`).catch(()=>{}),O.fire({title:"Time's up!",text:"This match ended with no rewards.",icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back",confirmButtonColor:"#64748b"}).then(()=>window.location.href="/play/matchmaking"))},250);return()=>clearInterval(t)},[_]);const Ae=o.useMemo(()=>p==null?"—:—":ke(p),[p]),Oe=t=>{const r=t.id??t.submission_id??`${t.user_id}-${t.at??t.created_at??t.timestamp??""}`,l=String(r),i=t.is_correct??t.correct??0,m=typeof i=="boolean"?i:Number(i)===1,a=t.at??t.created_at??t.timestamp??new Date().toISOString(),E=new Date(a),C=Number.isNaN(E.getTime())?Date.now():E.getTime(),L=typeof t.by_me=="boolean"?t.by_me:typeof t.byMe=="boolean"?t.byMe:Number(t.user_id)===Number(s.me);return{id:l,byMe:L,correct:m,text:L?m?"You submitted: Correct!":"You submitted: Wrong.":m?"Opponent submitted: Correct!":"Opponent submitted: Wrong.",ts:C}},ue=t=>t==="hard"?6:t==="medium"?4:3,pe=async t=>{var r,l,i;try{const m=await A.get(`/api/match/${t}/status`),a=(m==null?void 0:m.data)??m;if(a!=null&&a.opponent&&Te({id:Number(a.opponent.id),name:a.opponent.name,avatar_url:a.opponent.avatar_url}),a!=null&&a.ends_at){const f=a!=null&&a.server_now?new Date(a.server_now).getTime():Date.now(),w=new Date(a.ends_at).getTime(),y=Math.max(0,w-f);R.current=y,Y.current=!1,K(Date.now()+y),P(y)}else if(typeof(a==null?void 0:a.remaining_seconds)=="number"){const f=Math.max(0,a.remaining_seconds*1e3);R.current=f,Y.current=!1,K(Date.now()+f),P(f)}const E=Array.isArray(a==null?void 0:a.submissions)&&a.submissions.length>0?Math.max(...a.submissions.map(f=>{const w=f.at??f.created_at??f.timestamp??null,y=w?new Date(w).getTime():0;return Number.isFinite(y)?y:0})):0,C=((r=a==null?void 0:a.last)==null?void 0:r.at)??((l=a==null?void 0:a.last)==null?void 0:l.created_at)??null,L=C?new Date(C).getTime():0,M=Math.max(E,L);if(M&&M<ce.current)return;if(Array.isArray(a==null?void 0:a.submissions)){const f=a.submissions.map(Oe).sort((x,v)=>x.ts-v.ts),w=[];for(const x of f)if(!ie.current.has(x.id)&&(ie.current.add(x.id),w.push(x),!x.byMe)){const v=!!x.correct;ne(v?"correct":"wrong"),Me(v?"success":"fail"),Z(!0),Ce({text:v?"Correct Solution!":"Wrong Solution",correct:v,time:new Date(x.ts).toLocaleTimeString()}),v?(V("smirk"),$("success"),Be(),setTimeout(()=>V("base"),1200),setTimeout(()=>Z(!1),1600)):(V("sad"),$("fail"),setTimeout(()=>V("think"),1200),setTimeout(()=>Z(!1),1500)),setTimeout(()=>ne("idle"),2e3)}w.length>0&&je(x=>{const v=[...x,...w];return v.slice(Math.max(0,v.length-40))});const y=[...f].filter(x=>!x.byMe).sort((x,v)=>v.ts-x.ts)[0];y&&y.id!==le.current&&(le.current=y.id,O.fire({icon:y.correct?"success":"info",title:"Opponent Submitted!",text:y.correct?"They got it right!":"Their solution needs work.",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#1f2937",color:"#fff"}))}if(!W.current){if(a!=null&&a.finished)if(W.current=!0,Number(a==null?void 0:a.winner_user_id)===Number(s.me)){if($("success"),!q.current){q.current=!0;try{await A.post(`/api/match/${s.id}/award`,{language:s.language,difficulty:s.difficulty})}catch{}}const w=ue(s.difficulty);U(!0),await O.fire({title:"You win! 🎉",html:`<div class="text-zinc-300 text-sm">Great job — your solution passed the tests first.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${w} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}else $("fail"),U(!0),setTimeout(()=>U(!1),4e3),await O.fire({title:"Opponent won",html:`<div class="text-zinc-300 text-sm">They solved it first — good try!<br/>
                     <div class="mt-2 font-semibold text-rose-300">-1 ⭐</div></div>`,icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back to queue",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else if((i=a==null?void 0:a.last)!=null&&i.message&&String(a.last.message).toLowerCase()==="surrendered")if(W.current=!0,Number(a.last.user_id)===Number(s.me))await O.fire({title:"You surrendered",icon:"warning",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"OK",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else{if($("success"),!q.current){q.current=!0;try{await A.post(`/api/match/${s.id}/award`,{})}catch{}}const w=ue(s.difficulty);U(!0),await O.fire({title:"Opponent surrendered 🏆",html:`<div class="text-zinc-300 text-sm">Victory by surrender.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${w} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}}M&&(ce.current=M)}catch(m){console.error("Error fetching match status:",m)}},Be=()=>{const t=document.querySelector(".opp-avatar-wrap");t&&(t.classList.remove("avatar-ripple"),t.offsetWidth,t.classList.add("avatar-ripple"),setTimeout(()=>t.classList.remove("avatar-ripple"),900))};o.useEffect(()=>{let t=!0;pe(s.id);const r=setInterval(()=>{t&&pe(s.id)},1300);return()=>{t=!1,clearInterval(r)}},[s.id,s.me]);const De=async()=>{var t,r,l;try{const{data:i}=await A.post(`/api/match/${s.id}/submit`,{code:u});i!=null&&i.correct?b({type:"success",text:"✅ Correct! Finalizing…"}):($("tick"),b({type:"error",text:"❌ Wrong — keep trying!"}))}catch(i){console.error("[SUBMIT ERROR]",((t=i==null?void 0:i.response)==null?void 0:t.data)||i),b({type:"error",text:((l=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:l.message)||"Submit failed."})}},[te,fe]=o.useState(!1),Ie=async()=>{var t,r;if(!te){fe(!0);try{await A.post(`/api/match/${s.id}/surrender`,{}),b({type:"error",text:"You surrendered."})}catch(l){b({type:"error",text:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to surrender."})}finally{fe(!1)}}};return[...G].filter(t=>!t.byMe).sort((t,r)=>r.ts-t.ts)[0],e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:[e.jsx("style",{children:`
        .hide-app-header #app-header,
        .hide-app-header .app-header,
        .hide-app-header header[role="banner"] { display: none !important; }
      `}),e.jsxs(Ye,{breadcrumbs:[{title:"Home",href:"/dashboard"},{title:"Match",href:`/play/m/${s.id}`}],children:[e.jsx(Fe,{title:`Match ${s.id}`}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6",children:[e.jsx(ot,{active:$e,type:"win"}),e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-indigo-400 via-fuchsia-400 to-cyan-400 bg-clip-text text-transparent",children:["1v1 Duel — ",s.language.toUpperCase()," / ",s.difficulty.toUpperCase()]}),e.jsx("span",{className:"text-zinc-400 text-sm hidden md:inline",children:"Both players received the same AI-generated challenge."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:["inline-flex items-center gap-2 rounded-lg px-3 py-1.5 border text-zinc-300",z==="ok"?"border-slate-700/60":"",z==="warning"?"border-amber-500/60 bg-amber-500/10":"",z==="danger"?"border-rose-500/60 bg-rose-500/10 animate-pulse":"",z==="muted"?"border-slate-700/60 opacity-70":""].join(" "),title:"Match timer",children:[e.jsx(Ve,{className:["w-4 h-4",z==="danger"?"text-rose-400":z==="warning"?"text-amber-400":"text-cyan-400"].join(" ")}),e.jsx("span",{className:"tabular-nums",children:Ae})]}),_&&p!=null&&e.jsx("div",{className:"w-40 h-1.5 bg-slate-800/60 rounded-full overflow-hidden ml-3",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-[width] duration-300",style:{width:R.current&&p!=null&&R.current>0?`${Math.max(0,Math.min(100,p/R.current*100))}%`:"0%"}})}),e.jsxs("button",{onClick:()=>Ne(t=>!t),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",title:"Toggle sounds",children:[D?e.jsx(We,{className:"w-4 h-4"}):e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:D?"SFX on":"SFX off"})]}),e.jsxs("button",{onClick:()=>Q(!0),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Live feed"})]}),e.jsx("button",{onClick:Ie,disabled:te||p!=null&&p<=0,className:"text-sm px-3 py-2 rounded-lg border border-slate-700/60 disabled:opacity-50 hover:bg-rose-900/20 transition-colors",children:te?"Surrendering…":"Surrender"}),e.jsxs("div",{className:"ml-2 hidden md:flex items-center gap-3 text-zinc-300",children:[e.jsx(xe,{className:"w-5 h-5"}),e.jsxs("span",{children:["you #",s.me]}),e.jsx("span",{className:"opacity-40",children:"vs"}),e.jsx(xe,{className:"w-5 h-5"}),e.jsxs("span",{children:["opponent #",s.opponent]})]})]})]}),h&&e.jsxs("div",{className:`mb-4 flex items-center gap-2 px-4 py-2 rounded-lg ${h.type==="success"?"bg-green-900/40 text-green-300":"bg-red-900/40 text-red-300"} animate-bounceIn`,children:[h.type==="success"?e.jsx(be,{className:"w-4 h-4"}):e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:h.text})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-cyan-400"}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:_e})]}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:Re})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"Your Code"}),e.jsx("textarea",{value:u,onChange:t=>j(t.target.value),className:"w-full h-[380px] md:h-[520px] rounded-lg bg-slate-950 border border-slate-700/60 p-3 text-sm text-zinc-100 font-mono focus:border-cyan-500/50 focus:ring-1 focus:ring-cyan-500/30 transition-colors",spellCheck:!1}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-zinc-500 flex items-center gap-2",children:[e.jsx(qe,{className:"w-3 h-3"})," ",Le," Tests",e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Qe,{className:"w-3 h-3"})," ",ze,e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Ge,{className:"w-3 h-3"})," ",Ee]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:De,disabled:p!=null&&p<=0,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-cyan-500 to-indigo-600 text-white font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-95 hover:shadow-lg hover:shadow-cyan-500/20",children:"Submit Solution"}),ee&&e.jsxs("button",{onClick:()=>ye(!T),className:"px-3 py-2 rounded-lg border border-slate-700/60 text-xs flex items-center gap-1 hover:bg-slate-800/40 transition-colors",children:[e.jsx(Ke,{className:"w-4 h-4"}),T?"Hide Solution":"Show Solution"]})]})]}),T&&ee&&e.jsx("pre",{className:"mt-3 p-3 rounded-lg bg-black/40 text-green-300 text-xs overflow-x-auto border border-emerald-500/20",children:ee})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(et,{className:"w-4 h-4 text-amber-300"}),re!=="idle"&&e.jsx("span",{className:`absolute -top-1 -right-1 w-2 h-2 rounded-full ${re==="correct"?"bg-emerald-400 animate-ping":"bg-rose-400 animate-ping"}`})]}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:"Opponent Activity"}),e.jsxs("span",{className:"ml-auto text-xs text-zinc-500 flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"})," Live"]})]}),e.jsxs("div",{className:"p-4 h-[460px] md:h-[560px] flex items-center justify-center relative",children:[oe&&e.jsx(it,{type:oe,active:Se}),e.jsx("div",{className:"opp-avatar-wrap absolute",children:e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-full border-2 border-transparent"})}),N?e.jsxs("div",{className:"text-center space-y-6 w-full",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:`absolute inset-0 rounded-full ${N.correct?"border-4 border-emerald-500/30 bg-emerald-900/10 animate-ping-slow":"border-4 border-rose-500/30 bg-rose-900/10 animate-pulse"}`}),e.jsx("div",{className:"absolute inset-4 rounded-full border-2 border-slate-700/60"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c!=null&&c.avatar_url?e.jsx("img",{src:H||S(c.avatar_url,"base")||(c==null?void 0:c.avatar_url)||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-40 h-40 object-contain select-none
                                ${k==="think"?"animate-opp-breathe":""}
                                ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                                ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):N.correct?e.jsx(Ze,{className:"w-12 h-12 text-yellow-300 animate-bounce"}):e.jsx(se,{className:"w-12 h-12 text-rose-300 animate-pulse"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full ${N.correct?"bg-emerald-900/40 text-emerald-300 border border-emerald-500/40":"bg-rose-900/40 text-rose-300 border border-rose-500/40"} animate-bounceIn`,children:[N.correct?e.jsx(be,{className:"w-5 h-5"}):e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:N.text})]}),e.jsxs("div",{className:"text-xs text-zinc-400 flex items-center justify-center gap-2",children:[e.jsx(he,{className:"w-3 h-3"}),N.time]})]}),e.jsx("div",{className:"w-full max-w-xs mx-auto bg-slate-800/50 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-1000 ${N.correct?"bg-emerald-500":"bg-rose-500"}`,style:{width:N.correct?"100%":"65%"}})})]}):e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-indigo-500/20 animate-ping-slow"}),e.jsx("div",{className:"absolute inset-3 rounded-full border-2 border-indigo-500/10 animate-pulse-slow"}),c!=null&&c.avatar_url?e.jsx("img",{src:H||S(c.avatar_url,"base")||(c==null?void 0:c.avatar_url)||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-44 h-44 object-contain select-none
                              ${k==="think"?"animate-opp-breathe":""}
                              ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                              ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):e.jsx("div",{className:"w-44 h-44 rounded-full bg-indigo-600/20 grid place-items-center border-2 border-slate-700/60",children:e.jsx(Ue,{className:"w-12 h-12 text-indigo-300 animate-bounce-slow"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-zinc-200",children:c!=null&&c.name?`${c.name}'s turn…`:"Waiting for opponent"}),e.jsx("p",{className:"text-sm text-zinc-400 max-w-xs mx-auto",children:"Your opponent hasn’t made a submission yet. Stay focused on your solution!"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-700/60",children:e.jsxs("p",{className:"text-xs text-zinc-400 text-center",children:["The panel updates in real-time when your opponent submits a solution.",N&&N.correct&&e.jsx("span",{className:"block mt-1 text-emerald-300 font-medium",children:"They solved it correctly! Hurry up!"})]})})]})]})]})]}),ve&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end md:items-center md:justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>Q(!1)}),e.jsxs("div",{className:"relative w-full md:w-[640px] max-h-[80vh] overflow-hidden rounded-t-2xl md:rounded-2xl border border-slate-700/60 bg-slate-900/90 backdrop-blur",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center justify-between",children:[e.jsxs("div",{className:"text-zinc-200 font-medium flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-cyan-400"}),"Live attempts"]}),e.jsx("button",{onClick:()=>Q(!1),className:"px-3 py-1.5 rounded-lg text-sm border border-slate-700/60",children:"Close"})]}),e.jsx("div",{className:"p-4 max-h-[65vh] overflow-y-auto",children:G.length===0?e.jsx("div",{className:"text-xs text-zinc-500",children:"No attempts yet."}):e.jsx("ul",{className:"space-y-1",children:[...G].sort((t,r)=>r.ts-t.ts).map(t=>e.jsxs("li",{className:"text-xs",children:[e.jsx("span",{className:t.correct?"text-green-300":"text-red-300",children:t.correct?"✔":"✖"})," ",t.text," ",e.jsxs("span",{className:"opacity-50",children:["(",new Date(t.ts).toLocaleTimeString(),")"]})]},t.id))})})]})]}),e.jsx("style",{children:`
        @keyframes bounceIn {
          0% { transform: scale(0.8); opacity: 0; }
          50% { transform: scale(1.1); }
          100% { transform: scale(1); opacity: 1; }
        }
        .animate-bounceIn { animation: bounceIn 0.5s ease-out; }
        
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin-slow { animation: spin-slow 3s linear infinite; }
        
        @keyframes ping-slow { 0% { transform: scale(1); opacity: 1; } 75%, 100% { transform: scale(2); opacity: 0; } }
        .animate-ping-slow { animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite; }
        
        @keyframes pulse-slow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* Avatar motions */
        @keyframes opp-breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.04); } }
        .animate-opp-breathe { animation: opp-breathe 3.2s ease-in-out infinite; }

        @keyframes opp-shake {
          0%, 100% { transform: translateX(0); }
          15% { transform: translateX(-10px) rotate(-1deg); }
          30% { transform: translateX(10px) rotate(1deg); }
          45% { transform: translateX(-6px) rotate(-1deg); }
          60% { transform: translateX(6px) rotate(1deg); }
          75% { transform: translateX(-3px) rotate(-1deg); }
        }
        .animate-opp-shake { animation: opp-shake 0.8s ease-in-out; }

        @keyframes opp-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-14px) scale(1.02); } }
        .animate-opp-bounce { animation: opp-bounce 0.8s ease-in-out; }

        /* Glow halos */
        .avatar-glow-green { box-shadow: 0 0 0 0 rgba(16,185,129,0.45); animation: glow-green 1.2s ease-out; border-radius: 16px; }
        .avatar-glow-red { box-shadow: 0 0 0 0 rgba(244,63,94,0.45); animation: glow-red 1.0s ease-out; border-radius: 16px; }
        @keyframes glow-green { 0%{ box-shadow: 0 0 0 0 rgba(16,185,129,0.55);} 100%{ box-shadow: 0 0 40px 10px rgba(16,185,129,0);} }
        @keyframes glow-red { 0%{ box-shadow: 0 0 0 0 rgba(244,63,94,0.55);} 100%{ box-shadow: 0 0 36px 8px rgba(244,63,94,0);} }

        /* Shockwave ripple (correct) */
        .avatar-ripple::after {
          content: '';
          position: absolute; inset: -8px;
          border: 3px solid rgba(16,185,129,0.45);
          border-radius: 9999px;
          animation: ripple 0.9s ease-out forwards;
        }
        @keyframes ripple { 0%{ transform: scale(0.7); opacity: 1;} 100%{ transform: scale(1.4); opacity: 0;} }

        /* Existing slow bounce for fallback */
        @keyframes bounce-slow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .animate-bounce-slow { animation: bounce-slow 2s ease-in-out infinite; }
      `})]})}export{kt as default};
