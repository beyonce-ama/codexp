import{r as c,j as e,K as ps,L as Xe}from"./app-BNWgO-Fz.js";import{a as Z,A as Ue,T as Be}from"./app-layout-CBOUSF6H.js";import{A as us}from"./AnimatedBackground-DBoBMLV7.js";import{L as ze}from"./loader-circle-BGBuj12t.js";import{A as fs}from"./activity-ZUpVoc6G.js";import{M as Oe}from"./medal-rhNea7Ol.js";import{S as F,U as gs,C as bs}from"./users-BWLL3Z1M.js";import{Z as Fe}from"./zap-SDsdji4V.js";import{T as I}from"./trophy-9kVKDqQe.js";import{M as js,i as vs,u as Je,P as Ns,a as ys,b as ws,L as _s,m as ks}from"./proxy-D4-STVTg.js";import{C as Cs}from"./crown-BLKiU3o1.js";import{C as Ss}from"./cpu-D8uM0RJJ.js";import{T as Ge}from"./trending-up-Cf4z2ySD.js";import{C as As}from"./circle-check-big-CC-7ecby.js";import{a as Ps,S as Ye}from"./x-CyKYgiHF.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-DqtvVx51.js";class Ls extends c.Component{getSnapshotBeforeUpdate(r){const t=this.props.childRef.current;if(t&&r.isPresent&&!this.props.isPresent){const b=t.offsetParent,h=vs(b)&&b.offsetWidth||0,d=this.props.sizeRef.current;d.height=t.offsetHeight||0,d.width=t.offsetWidth||0,d.top=t.offsetTop,d.left=t.offsetLeft,d.right=h-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function $s({children:o,isPresent:r,anchorX:t,root:b}){const h=c.useId(),d=c.useRef(null),A=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:L}=c.useContext(js);return c.useInsertionEffect(()=>{const{width:D,height:p,top:P,left:u,right:x}=A.current;if(r||!d.current||!D||!p)return;const w=t==="left"?`left: ${u}`:`right: ${x}`;d.current.dataset.motionPopId=h;const N=document.createElement("style");L&&(N.nonce=L);const _=b??document.head;return _.appendChild(N),N.sheet&&N.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${D}px !important;
            height: ${p}px !important;
            ${w}px !important;
            top: ${P}px !important;
          }
        `),()=>{_.contains(N)&&_.removeChild(N)}},[r]),e.jsx(Ls,{isPresent:r,childRef:d,sizeRef:A,children:c.cloneElement(o,{ref:d})})}const Es=({children:o,initial:r,isPresent:t,onExitComplete:b,custom:h,presenceAffectsLayout:d,mode:A,anchorX:L,root:D})=>{const p=Je(Ms),P=c.useId();let u=!0,x=c.useMemo(()=>(u=!1,{id:P,initial:r,isPresent:t,custom:h,onExitComplete:w=>{p.set(w,!0);for(const N of p.values())if(!N)return;b&&b()},register:w=>(p.set(w,!1),()=>p.delete(w))}),[t,p,b]);return d&&u&&(x={...x}),c.useMemo(()=>{p.forEach((w,N)=>p.set(N,!1))},[t]),c.useEffect(()=>{!t&&!p.size&&b&&b()},[t]),A==="popLayout"&&(o=e.jsx($s,{isPresent:t,anchorX:L,root:D,children:o})),e.jsx(Ns.Provider,{value:x,children:o})};function Ms(){return new Map}const se=o=>o.key||"";function Ke(o){const r=[];return c.Children.forEach(o,t=>{c.isValidElement(t)&&r.push(t)}),r}const Ts=({children:o,custom:r,initial:t=!0,onExitComplete:b,presenceAffectsLayout:h=!0,mode:d="sync",propagate:A=!1,anchorX:L="left",root:D})=>{const[p,P]=ys(A),u=c.useMemo(()=>Ke(o),[o]),x=A&&!p?[]:u.map(se),w=c.useRef(!0),N=c.useRef(u),_=Je(()=>new Map),[X,te]=c.useState(u),[$,G]=c.useState(u);ws(()=>{w.current=!1,N.current=u;for(let k=0;k<$.length;k++){const f=se($[k]);x.includes(f)?_.delete(f):_.get(f)!==!0&&_.set(f,!1)}},[$,x.length,x.join("-")]);const U=[];if(u!==X){let k=[...u];for(let f=0;f<$.length;f++){const E=$[f],B=se(E);x.includes(B)||(k.splice(f,0,E),U.push(E))}return d==="wait"&&U.length&&(k=U),G(Ke(k)),te(u),null}const{forceRender:Y}=c.useContext(_s);return e.jsx(e.Fragment,{children:$.map(k=>{const f=se(k),E=A&&!p?!1:u===$||x.includes(f),B=()=>{if(_.has(f))_.set(f,!0);else return;let z=!0;_.forEach(K=>{K||(z=!1)}),z&&(Y==null||Y(),G(N.current),A&&(P==null||P()),b&&b())};return e.jsx(Es,{isPresent:E,initial:!w.current||t?void 0:!1,custom:r,presenceAffectsLayout:h,mode:d,root:D,onExitComplete:E?void 0:B,anchorX:L,children:k},f)})})},He=[{title:"Home",href:"/dashboard"},{title:"Dashboard",href:"/dashboard"}],Ws=o=>Math.floor(o/10)+1,Ze=o=>o%10,Is=o=>Ze(o)/10*100;function et(){var fe,ge,be,je,ve,Ne,ye,we,_e,ke,Ce,Se,Ae,Pe,Le,$e,Ee,Me,Te,We,Ie,De,Ve;const{auth:o}=ps().props,r=o==null?void 0:o.user,[t,b]=c.useState(null),[h,d]=c.useState([]),[A,L]=c.useState(!0),[D,p]=c.useState(!1),[P,u]=c.useState(null),[x,w]=c.useState([]),[N,_]=c.useState(0),[X,te]=c.useState("Current Season"),$=s=>{switch(s){case"Solo":return"bg-blue-900/30 border-blue-800 text-blue-300";case"Solo+AI":return"bg-indigo-900/30 border-indigo-800 text-indigo-300";case"Invite Duel":return"bg-rose-900/30 border-rose-800 text-rose-300";case"Live Match":return"bg-amber-900/30 border-amber-800 text-amber-300";case"Python":return"bg-emerald-900/30 border-emerald-800 text-emerald-300";case"Java":return"bg-orange-900/30 border-orange-800 text-orange-300";case"C++":return"bg-blue-900/30 border-blue-800 text-blue-300";default:return"bg-slate-900/30 border-slate-700 text-slate-300"}},G=s=>{if(!s)return null;const l=String(s).trim();return/^(https?:\/\/|data:)/i.test(l)||l.startsWith("/")?l:l.startsWith("avatars/")||l.startsWith("storage/")?`/${l}`:`/avatars/${l}`},U=s=>s?s.startsWith("SOLO_AI_")?"Solo+AI":s.startsWith("SOLO_")?"Solo":s.startsWith("PVP_INVITE_")?"Invite Duel":s.startsWith("PVP_LIVE_")?"Live Match":s.startsWith("LANG_PY_")?"Python":s.startsWith("LANG_JAVA_")?"Java":s.startsWith("LANG_CPP_")?"C++":"General":"General",Y=s=>s&&typeof s=="object"&&("code"in s||"threshold"in s||"xp_reward"in s||"name"in s||"goal"in s),k=s=>{const l=Number(s.threshold??s.goal??0),a=Number(s.current??s.count??0),n=s.progress!=null?Number(s.progress):l>0?Math.min(100,Math.round(a/l*100)):0,i=Number.isFinite(n)?Math.max(0,Math.min(100,n)):0,y=l>0&&a>=l||i>=100,V=!!(s.claimed??s.is_claimed??!1),R=!!(s.unlocked??y),M=!!(s.can_claim??(R&&!V)),g=s.code??s.key??s.name??"",j=s.name??s.title??s.code,T=s.description??s.desc,ee=s.icon_key??s.icon,J=s.xp_reward??s.xp,v=s.stars_reward??s.stars,S=s.scope??s.category??s.group;return{id:Number.isFinite(Number(s.id))?Number(s.id):void 0,code:String(g),name:String(j??"Achievement"),description:T??void 0,icon_key:ee??null,threshold:l,current:a,progress:i,unlocked:R,claimed:V,can_claim:M,xp_reward:Number(J??0),stars_reward:Number(v??0),__scope:S??U(String(g))}},f=s=>{const l=[],a=i=>{if(!i)return;if(Array.isArray(i)){i.forEach(a);return}if(typeof i!="object")return;if(Y(i)){l.push(k(i));return}const y=[i.items,i.achievements,i.tasks,i.groups,i.categories,i.data].filter(Boolean);y.length?y.forEach(a):Object.values(i).forEach(a)};a(s);const n=new Set;return l.filter(i=>{const y=i.id!=null?`id:${i.id}`:`code:${i.code}|scope:${i.__scope??""}`;return n.has(y)?!1:(n.add(y),!0)})};c.useEffect(()=>{E(!0)},[]);const E=async(s=!1)=>{var l,a,n,i,y,V,R;try{s&&L(!0);const[M,g,j]=await Promise.all([Z.get("/api/me/stats"),Z.get("/api/users/participants"),Z.get("/api/achievements/progress")]),T=((l=j==null?void 0:j.data)==null?void 0:l.items)??((a=j==null?void 0:j.data)==null?void 0:a.data)??(j==null?void 0:j.data)??j,ee=f(T);if(w(ee),as){const J=ee.filter(v=>v.can_claim);for(const v of J)try{const S=await Z.post("/api/achievements/claim",{achievement_id:v.id}),m=((n=S==null?void 0:S.data)==null?void 0:n.xp_reward)??v.xp_reward??0,W=((i=S==null?void 0:S.data)==null?void 0:i.stars_reward)??v.stars_reward??0;ue({name:v.name,xp:m,stars:W,icon_key:v.icon_key??void 0})}catch(S){console.error("Auto-claim failed",v.id,S)}}if(_(Number((T==null?void 0:T.solo_completed)??(T==null?void 0:T.completed)??((y=j==null?void 0:j.data)==null?void 0:y.solo_completed)??0)),M!=null&&M.success&&M.data&&(b(M.data),u(new Date)),g!=null&&g.success){const J=Array.isArray(g.data)?g.data:Array.isArray((V=g.data)==null?void 0:V.data)?g.data.data:[],v=(g==null?void 0:g.season)??((R=g==null?void 0:g.data)==null?void 0:R.season)??null;v!=null&&v.name&&te(v.name);const S=J.map(m=>{var Re;const W=Number(m.total_xp??m.season_xp??0),ds=Number(m.stars??m.season_stars??0),ms=Number(m.crowns??0),xs=m.last_season_rank??null,hs=G(m.avatar??((Re=m.profile)==null?void 0:Re.avatar)??null);return{id:m.id,name:m.name,email:m.email,avatar:hs,total_xp:W,stars:ds,level:Math.floor(W/10)+1,crowns:ms,last_season_rank:xs}}).sort((m,W)=>W.total_xp-m.total_xp||W.stars-m.stars).map((m,W)=>({...m,rank:W+1}));d(S)}}catch(M){console.error("Error fetching dashboard/leaderboard:",M)}finally{L(!1),p(!1)}},B=((fe=t==null?void 0:t.user)==null?void 0:fe.stars)??((ge=t==null?void 0:t.totals)==null?void 0:ge.stars)??0,z=(be=t==null?void 0:t.solo_stats)!=null&&be.total_attempts?Math.round(t.solo_stats.successful_attempts/t.solo_stats.total_attempts*100):0,K=(je=t==null?void 0:t.ai_stats)!=null&&je.ai_attempts?Math.round(t.ai_stats.ai_successful_attempts/t.ai_stats.ai_attempts*100):0,oe=(((ve=t==null?void 0:t.solo_stats)==null?void 0:ve.total_attempts)||0)+(((Ne=t==null?void 0:t.ai_stats)==null?void 0:Ne.ai_attempts)||0),de=(((ye=t==null?void 0:t.solo_stats)==null?void 0:ye.successful_attempts)||0)+(((we=t==null?void 0:t.ai_stats)==null?void 0:we.ai_successful_attempts)||0),ae=oe>0?Math.round(de/oe*100):0,qe=(t==null?void 0:t.duels_played)??0,Qe=(t==null?void 0:t.duels_won)??0,es=(t==null?void 0:t.live_played)??(t==null?void 0:t.matches_played)??0,ss=(t==null?void 0:t.live_won)??(t==null?void 0:t.matches_won)??0,le=qe+es,me=Qe+ss,ts=le?Math.round(me/le*100):0,re=h.find(s=>s.id===(r==null?void 0:r.id)),H=(re==null?void 0:re.rank)??null,[xe,he]=c.useState(null),as=!0,[ls,q]=c.useState(!1),ne=c.useRef(null);c.useEffect(()=>{const s=a=>{ne.current&&(ne.current.contains(a.target)||q(!1))},l=a=>{a.key==="Escape"&&q(!1)};return document.addEventListener("mousedown",s),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",l)}},[]);const[rs,pe]=c.useState([]),ue=s=>{const l=`${Date.now()}-${Math.random().toString(36).slice(2)}`;pe(a=>[...a,{id:l,...s}]),setTimeout(()=>pe(a=>a.filter(n=>n.id!==l)),3500)},ns=async s=>{var l,a;try{he(s);const n=x.find(R=>R.id===s),i=await Z.post("/api/achievements/claim",{achievement_id:s}),y=((l=i==null?void 0:i.data)==null?void 0:l.xp_reward)??(n==null?void 0:n.xp_reward)??0,V=((a=i==null?void 0:i.data)==null?void 0:a.stars_reward)??(n==null?void 0:n.stars_reward)??0;ue({name:(n==null?void 0:n.name)||"Achievement",xp:y,stars:V,icon_key:(n==null?void 0:n.icon_key)??void 0}),await E(!1)}catch(n){console.error("Claim failed",n)}finally{he(null)}},Q=Ws(((_e=t==null?void 0:t.totals)==null?void 0:_e.xp)||0),ie=Ze(((ke=t==null?void 0:t.totals)==null?void 0:ke.xp)||0),is=Is(((Ce=t==null?void 0:t.totals)==null?void 0:Ce.xp)||0),cs=s=>s===1?{label:"Gold",className:"text-yellow-400",chip:"bg-yellow-500/15 border-yellow-700"}:s===2?{label:"Silver",className:"text-slate-200",chip:"bg-slate-400/10 border-slate-500"}:s===3?{label:"Bronze",className:"text-amber-500",chip:"bg-amber-500/10 border-amber-600"}:{label:"",className:"text-slate-300",chip:"bg-slate-800 border-slate-700"},O=({title:s,right:l,children:a,className:n=""})=>e.jsxs("section",{className:`bg-slate-800/50 border border-slate-700 rounded-2xl p-5 ${n}`,children:[e.jsxs("header",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-semibold tracking-wide",children:s}),l]}),a]}),ce=({icon:s,label:l,value:a})=>e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900/60 border border-slate-700 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-800 border border-slate-700",children:e.jsx(s,{className:"h-5 w-5 text-cyan-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:l}),e.jsx("p",{className:"text-base font-semibold text-white",children:a})]})]}),os=({value:s})=>e.jsx("div",{className:"w-full h-3 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-cyan-500 via-blue-500 to-fuchsia-500",style:{width:`${s}%`}})}),C=({title:s,value:l,icon:a,description:n,tone:i="slate"})=>{const y={slate:"bg-slate-900/60 border-slate-700 text-slate-200",green:"bg-emerald-900/30 border-emerald-800 text-emerald-300",indigo:"bg-indigo-900/30 border-indigo-800 text-indigo-300",amber:"bg-amber-900/30 border-amber-800 text-amber-300",rose:"bg-rose-900/30 border-rose-800 text-rose-300",purple:"bg-purple-900/30 border-purple-800 text-purple-300",cyan:"bg-cyan-900/30 border-cyan-800 text-cyan-300",blue:"bg-blue-900/30 border-blue-800 text-blue-300",yellow:"bg-yellow-900/30 border-yellow-800 text-yellow-300",red:"bg-red-900/30 border-red-800 text-red-300"};return e.jsx("div",{className:`rounded-xl border p-4 ${y[i]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:l}),n&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:n})]})]})})};return A?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:e.jsxs(Ue,{breadcrumbs:He,children:[e.jsx(Xe,{title:"Dashboard"}),e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ze,{className:"h-8 w-8 animate-spin mx-auto mb-3 text-cyan-400"}),e.jsx("div",{className:"text-slate-300",children:"Loading your dashboard…"})]})})]})}):e.jsxs("div",{className:"min-h-screen relative overflow-x-hidden scroll-smooth",children:[e.jsx("div",{className:"pointer-events-none fixed inset-0 -z-10","aria-hidden":"true",children:e.jsx(us,{})}),e.jsxs(Ue,{breadcrumbs:He,children:[e.jsx(Xe,{title:"Dashboard"}),e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fs,{className:"h-7 w-7 text-cyan-400"}),e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:["Welcome back, ",r==null?void 0:r.name,"!"]})]}),e.jsxs("p",{className:"text-slate-400",children:["Ready for your next coding challenge?",P&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• Updated ",P.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-400 mb-1",children:(X==null?void 0:X.toUpperCase())||"CURRENT SEASON"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[H!=null&&e.jsx(ce,{icon:Oe,label:"Rank",value:`#${H}`}),e.jsx(ce,{icon:F,label:"Season Stars",value:((Se=h.find(s=>s.id===(r==null?void 0:r.id)))==null?void 0:Se.stars)??0}),e.jsx(ce,{icon:Fe,label:"Season XP",value:((Ae=h.find(s=>s.id===(r==null?void 0:r.id)))==null?void 0:Ae.total_xp)??0})]})]}),e.jsxs("div",{ref:ne,className:"relative",children:[e.jsxs("button",{onClick:()=>q(s=>!s),className:"inline-flex items-center gap-2 rounded-xl px-4 py-2 bg-slate-800 border border-slate-700 text-white hover:bg-slate-700",title:"View Achievements",children:[e.jsx(I,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{children:"Achievements"})]}),e.jsx(Ts,{children:ls&&e.jsx(ks.div,{initial:{opacity:0,y:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-6,scale:.98},transition:{type:"spring",stiffness:380,damping:28,mass:.6},className:"absolute right-0 mt-2 w-[28rem] max-w-[90vw] z-[60]",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-900/95 shadow-2xl backdrop-blur p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-yellow-400"}),e.jsx("h3",{className:"text-white font-semibold tracking-wide text-sm",children:"Achievements"})]}),e.jsx("button",{onClick:()=>q(!1),className:"inline-flex items-center justify-center rounded-lg border border-slate-600 text-slate-200 hover:bg-slate-800 w-7 h-7",title:"Close",children:"✕"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"My Trophies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.filter(s=>s.claimed).length===0?e.jsx("span",{className:"text-slate-500 text-xs",children:"No trophies yet."}):x.filter(s=>s.claimed).slice(0,12).map(s=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-700 bg-slate-900/60 px-2 py-1",children:[s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,alt:s.icon_key||"trophy",className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-[11px] text-white truncate max-w-[180px]",title:s.name,children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"Tasks"}),x.filter(s=>!s.claimed).length===0?e.jsx("div",{className:"text-slate-400 text-sm",children:"No tasks available."}):(()=>{const s=a=>a.can_claim?3:a.unlocked?2:a.progress>0?1:0,l=[...x].filter(a=>!a.claimed).sort((a,n)=>{const i=s(n)-s(a);return i!==0?i:n.progress-a.progress});return e.jsx("div",{className:"space-y-2 max-h-[45vh] overflow-y-auto pr-1",children:l.slice(0,8).map(a=>{const n=U(a.code);return e.jsx("div",{className:`rounded-xl border p-3 ${a.unlocked?"bg-yellow-900/10 border-yellow-800":"bg-slate-900/60 border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:a.icon_key?e.jsx("img",{src:`/trophies/${a.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(I,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("p",{className:"text-white font-medium truncate",title:a.name,children:a.name}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full border ${$(n)}`,children:n})]}),a.can_claim?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-amber-900/30 border border-amber-800 text-amber-300",children:"Ready to claim"}):a.unlocked?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-yellow-900/20 border border-yellow-800 text-yellow-300",children:"Completed"}):a.progress>0?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-cyan-900/30 border border-cyan-800 text-cyan-300",children:"In progress"}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-slate-800 border border-slate-600 text-slate-300",children:"Locked"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-2 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a.unlocked?"bg-gradient-to-r from-yellow-400 to-amber-500":"bg-gradient-to-r from-cyan-500 to-blue-500"}`,style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mt-1",children:[e.jsxs("span",{children:[Math.min(a.current,a.threshold)," / ",a.threshold]}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-[10px] text-slate-400",children:["Reward: ",e.jsxs("span",{className:"text-white font-medium",children:["+",a.xp_reward," XP"]})," •"," ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3 text-yellow-400"})," ",a.stars_reward]})]}),a.can_claim&&e.jsx("button",{onClick:()=>ns(a.id),disabled:xe===a.id,className:"text-[11px] inline-flex items-center gap-2 px-2.5 py-1 rounded-lg border border-yellow-700 bg-yellow-500/10 text-yellow-200 hover:bg-yellow-500/20 disabled:opacity-60",children:xe===a.id?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-3.5 w-3.5 animate-spin"}),"Claiming…"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-3.5 w-3.5"}),"Claim"]})})]})]})]})]})},a.id)})})})()]})]})})})]})]})]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs(O,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Level & Progress"})]}),right:e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-slate-400",children:"Next Level"}),e.jsxs("div",{className:"font-semibold text-cyan-300",children:[10-ie," XP needed"]})]}),children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white text-lg font-semibold",children:["Level ",Q]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",ie,"/10 XP)"]})]})}),e.jsx(os,{value:Math.round(is)}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2",children:[e.jsxs("span",{children:["Level ",Q]}),e.jsxs("span",{children:[ie," / 10 XP"]}),e.jsxs("span",{children:["Level ",Q+1]})]})]}),e.jsxs(O,{title:"Your KPIs",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(C,{title:"Total XP",value:((Pe=t==null?void 0:t.totals)==null?void 0:Pe.xp)||0,icon:Fe,tone:"yellow"}),e.jsx(C,{title:"Total Attempts",value:(((Le=t==null?void 0:t.solo_stats)==null?void 0:Le.total_attempts)||0)+((($e=t==null?void 0:t.ai_stats)==null?void 0:$e.ai_attempts)||0),icon:Be,tone:"blue"}),e.jsx(C,{title:"Solo Attempts",value:((Ee=t==null?void 0:t.solo_stats)==null?void 0:Ee.total_attempts)||0,icon:gs,tone:"indigo"}),e.jsx(C,{title:"AI Attempts",value:((Me=t==null?void 0:t.ai_stats)==null?void 0:Me.ai_attempts)||0,icon:Ss,tone:"cyan"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(C,{title:"Overall Success",value:`${ae}%`,icon:Ge,description:`${de} successful attempts`,tone:ae>70?"green":ae>50?"blue":"amber"}),e.jsx(C,{title:"Solo Success",value:`${z}%`,icon:As,description:`${((Te=t==null?void 0:t.solo_stats)==null?void 0:Te.successful_attempts)||0} successful solo attempts`,tone:z>70?"green":z>50?"blue":"amber"}),e.jsx(C,{title:"AI Success",value:`${K}%`,icon:Ps,description:`${((We=t==null?void 0:t.ai_stats)==null?void 0:We.ai_successful_attempts)||0} successful AI attempts`,tone:K>70?"green":K>50?"blue":"amber"})]})]}),e.jsx(O,{title:"Duel Performance",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(C,{title:"Stars Earned",value:B,icon:F,description:"Achievement stars",tone:"purple"}),e.jsx(C,{title:"Duels Played",value:le,icon:Ye,description:"Total matches (invite + live)",tone:"red"}),e.jsx(C,{title:"Duels Won",value:me,icon:I,description:"Victories (invite + live)",tone:"green"}),e.jsx(C,{title:"Win Rate",value:`${ts}%`,icon:Ge,description:"Success percentage",tone:"indigo"})]})}),e.jsx(O,{title:"Today's Activity",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-blue-900/30 border border-blue-800 mb-2",children:e.jsx(Be,{className:"h-6 w-6 text-blue-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((Ie=t==null?void 0:t.solo_stats)==null?void 0:Ie.attempts_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Solo Attempts Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-rose-900/30 border border-rose-800 mb-2",children:e.jsx(Ye,{className:"h-6 w-6 text-rose-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(t==null?void 0:t.duels_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Duels Started Today"})]})]})}),(t==null?void 0:t.language_stats)&&t.language_stats.length>0&&e.jsx(O,{title:"Language Proficiency",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols- gap-4",children:t.language_stats.map(s=>e.jsx(C,{title:s.language,value:`${s.winrate}%`,icon:bs,description:`${s.games_played} games played`,tone:s.winrate>70?"green":s.winrate>50?"blue":"amber"},s.id))})})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(O,{title:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Leaderboard"})]}),e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:X})]}),right:e.jsx("span",{className:"text-xs text-slate-400",children:"XP • Stars"}),className:"xl:sticky xl:top-4 xl:self-start",children:[h.slice(0,3).length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:h.slice(0,3).map(s=>{const l=cs(s.rank);return e.jsxs("div",{className:`rounded-xl p-3 border ${l.chip} text-center`,children:[e.jsx("div",{className:"mt-2 mx-auto w-12 h-12 rounded-full overflow-hidden ring-1 ring-slate-700/60",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Oe,{className:`h-5 w-5 ${l.className}`}),e.jsxs("span",{className:`text-sm font-semibold ${l.className}`,children:["#",s.rank]})]}),e.jsx("div",{className:"mt-1 text-white text-sm font-bold truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"text-[11px] text-slate-400",children:["Lvl ",s.level]}),e.jsxs("div",{className:"mt-1 text-xs text-cyan-300",children:[s.total_xp," XP"]})]},s.id)})}),e.jsxs("div",{className:"divide-y divide-slate-700/70 overflow-y-visible no-scrollbar",children:[h.slice(3,15).map(s=>e.jsxs("div",{className:"py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:`text-sm font-bold ${s.rank<=3?"text-yellow-400":"text-slate-300"}`,children:["#",s.rank]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-white font-medium truncate ${s.id===(r==null?void 0:r.id)?"underline decoration-dotted":""}`,title:s.name,children:s.id===(r==null?void 0:r.id)?"You":s.name}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",s.level]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.total_xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id)),h.length===0&&e.jsx("div",{className:"py-8 text-center text-slate-400",children:"No participants yet."})]}),H!=null&&H>15&&e.jsxs("div",{className:"mt-3 rounded-xl border border-cyan-800 bg-cyan-900/20 p-3",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Your Position"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:"text-sm font-bold text-cyan-300",children:["#",H]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:G(((De=r==null?void 0:r.profile)==null?void 0:De.avatar)??(r==null?void 0:r.avatar)??null)||"/avatars/default.png",alt:r==null?void 0:r.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium truncate",children:"You"}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",Q]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[((Ve=t==null?void 0:t.totals)==null?void 0:Ve.xp)??0," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3 text-yellow-400"})," ",B]})]})]})]})]})]})})]}),e.jsx("div",{className:"fixed top-4 right-4 z-[60] space-y-2",children:rs.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-yellow-700 bg-slate-900/90 backdrop-blur px-4 py-3 shadow-lg",children:[e.jsx("div",{className:"p-2 rounded-lg border border-yellow-700 bg-yellow-500/10",children:s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(I,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm text-white font-semibold truncate",title:s.name,children:["Achievement Unlocked: ",s.name]}),e.jsxs("p",{className:"text-xs text-slate-300",children:["+",s.xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id))})]}),e.jsx("style",{children:`
  .no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `})]})}export{et as default};
