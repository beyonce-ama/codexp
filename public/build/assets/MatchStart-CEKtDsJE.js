import{K as Xe,r as n,j as e,L as Fe}from"./app-GtahOJEu.js";import{a as O,A as Ye,V as Pe,c as We,U as fe,C as xe,T as Ve}from"./app-layout-BGU5i8aK.js";import{S as A}from"./sweetalert2.esm.all-acGi8jXx.js";import{T as He}from"./timer-Cbo17OGw.js";import{c as ge}from"./createLucideIcon-B9xt4YxH.js";import{C as he}from"./circle-check-big-7tjGsxcN.js";import{C as se}from"./circle-x-CO7PmmV6.js";import{B as Ue}from"./bolt-BxFKKrzH.js";import{C as qe}from"./code-xml-BnC095Pn.js";import{Z as Qe}from"./zap-CcCAyFdu.js";import{T as Ge}from"./trophy-x_z2y0vW.js";import{E as Ke}from"./eye-DdITcRoO.js";import{C as Ze}from"./crown-DYshOr_b.js";import"./utils-jAU0Cazi.js";import"./users-DwpEitiw.js";import"./x-CgTaxSWY.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]],et=ge("Hourglass",Je);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],be=ge("Radio",tt),we=d=>d?d.split("?")[0]:null,st=d=>{if(!d)return".png";const r=we(d).match(/\.(png|jpg|jpeg|webp|gif)$/i);return r?r[0]:".png"},at=d=>d?we(d).replace(/\.(png|jpg|jpeg|webp|gif)$/i,"").replace(/_(sad|think|smirk)$/i,""):null,S=(d,r="think")=>{if(!d)return null;const o=at(d);if(!o)return d;const x=st(d),v=r==="base"?"":`_${r}`;return`${`${o}${v}${x}`}?v=${Date.now()}`},B=d=>new Promise(r=>{const o=new Image;o.onload=()=>r(!0),o.onerror=()=>r(!1),o.src=d}),rt=async(d,r,o)=>{const x=r==="base"?["base","think"]:[r,"think","base"];for(const v of x){const h=S(d,v);if(h&&await B(h))return h}return o??await B(S(d,"base"))?S(d,"base"):null},nt=({active:d,type:r="win"})=>{const[o,x]=n.useState([]);return n.useEffect(()=>{if(d){const v=[],h=r==="win"?["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a","#ffb347"]:["#4ade80","#22d3ee","#fbbf24","#f472b6","#a78bfa","#60a5fa"];for(let j=0;j<70;j++)v.push({id:j,style:{left:"50%",top:"50%",backgroundColor:h[Math.floor(Math.random()*h.length)],transform:`rotate(${Math.random()*360}deg)`,opacity:0,width:`${8+Math.random()*8}px`,height:`${8+Math.random()*8}px`,borderRadius:Math.random()>.5?"50%":"0%"}});x(v),setTimeout(()=>{x(j=>j.map(T=>({...T,style:{...T.style,left:`${50+(Math.random()*100-50)}%`,top:`${50+(Math.random()*100-50)}%`,opacity:1,transition:`all ${.8+Math.random()*.7}s ease-out`}})))},10),setTimeout(()=>{x([])},4e3)}},[d,r]),!d||o.length===0?null:e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-10",children:o.map(v=>e.jsx("div",{className:"absolute",style:v.style},v.id))})},ot=({type:d,active:r})=>r?e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(25)].map((o,x)=>e.jsx("div",{className:`absolute w-3 h-3 rounded-full ${d==="success"?"bg-emerald-400":"bg-rose-400"}`,style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",animation:`particle-${d} 1.2s ease-out forwards`,animationDelay:`${x*.04}s`,opacity:0}},x)),e.jsx("style",{children:`
        @keyframes particle-success {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*120-60}px), 
              calc(-50% + ${Math.random()*120-60}px)
            ) scale(1.8) rotate(${Math.random()*360}deg); 
          }
        }
        @keyframes particle-fail {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
          20% { opacity: 1; }
          100% { 
            opacity: 0; 
            transform: translate(
              calc(-50% + ${Math.random()*100-50}px), 
              calc(-50% + ${Math.random()*100-50}px)
            ) scale(1.5) rotate(${Math.random()*360}deg); 
          }
        }
      `})]}):null;function Nt(){const{props:d}=Xe(),{match:r,challenge:o}=d,[x,v]=n.useState((o==null?void 0:o.buggy_code)??""),[h,j]=n.useState(null),[T,ye]=n.useState(!1),[ve,Q]=n.useState(!1),[G,je]=n.useState([]),[D,Ne]=n.useState(!0),I=n.useRef(null),X=n.useRef(null),F=n.useRef(null),[_,K]=n.useState(null),[u,W]=n.useState(null),Y=n.useRef(!1),R=n.useRef(null),E=n.useMemo(()=>u==null?"muted":u<=1e4?"danger":u<=6e4?"warning":"ok",[u]),ke=t=>{const a=Math.max(0,Math.floor(t/1e3)),c=Math.floor(a/60),i=a%60;return`${c.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},[ae,re]=n.useState("idle"),[Se,Z]=n.useState(!1),[ne,Me]=n.useState(null),[Ce,V]=n.useState(!1),[N,$e]=n.useState(null),[l,Te]=n.useState(null),[k,H]=n.useState("think"),[U,J]=n.useState(null);n.useEffect(()=>{let t=!1;return(async()=>{if(!(l!=null&&l.avatar_url)){J(null);return}const a=S(l.avatar_url,"think");a&&await B(a)&&!t&&J(a);const c=S(l.avatar_url,"sad");c&&B(c);const i=S(l.avatar_url,"smirk");i&&B(i);const m=S(l.avatar_url,"base");m&&B(m)})(),()=>{t=!0}},[l==null?void 0:l.avatar_url]),n.useEffect(()=>{let t=!1;return(async()=>{if(!(l!=null&&l.avatar_url))return;const a=await rt(l.avatar_url,k==="idle"?"think":k,U);!t&&a&&a!==U&&J(a)})(),()=>{t=!0}},[k,l==null?void 0:l.avatar_url]),n.useEffect(()=>(document.body.classList.add("hide-app-header"),()=>document.body.classList.remove("hide-app-header")),[]);const _e=(o==null?void 0:o.title)??"Fix the Bug",Re=(o==null?void 0:o.description)??"Repair the function to satisfy all tests.",Ee=((o==null?void 0:o.language)??r.language??"").toUpperCase(),Le=((o==null?void 0:o.difficulty)??r.difficulty??"").toUpperCase(),ze=Array.isArray(o==null?void 0:o.tests)?o.tests.length:0,ee=(o==null?void 0:o.corrected_code)??(o==null?void 0:o.fixed_code)??null,oe=n.useRef(new Set),ie=n.useRef(0),ce=n.useRef(null),q=n.useRef(!1),P=n.useRef(!1),b=n.useRef(null),le=(t,a=0,c=1)=>Math.max(a,Math.min(c,t)),de=(t,a,c)=>{const i=t.volume,m=le(a),s=Math.max(1,c),L=performance.now(),$=z=>{const M=le((z-L)/s);t.volume=i+(m-i)*M,M<1?requestAnimationFrame($):m===0&&(t.pause(),t.currentTime=0)};requestAnimationFrame($)};n.useEffect(()=>(document.body.classList.add("hide-app-header"),()=>document.body.classList.remove("hide-app-header")),[]),n.useEffect(()=>{var a,c,i;const t=m=>{const s=new Audio(m);return s.preload="auto",s.crossOrigin="anonymous",s};try{I.current=t("/sounds/tick.wav"),I.current.volume=.9}catch{}try{X.current=t("/sounds/correct.mp3"),X.current.volume=.95}catch{}try{F.current=t("/sounds/defeat.wav"),F.current.volume=.95}catch{}try{b.current||(b.current=t("/audio/bgm.mp3"),b.current.loop=!0,b.current.volume=0)}catch{}return D?b.current&&(b.current.play().catch(()=>{}),setTimeout(()=>{b.current&&de(b.current,.22,600)},60)):((a=I.current)==null||a.pause(),(c=X.current)==null||c.pause(),(i=F.current)==null||i.pause(),b.current&&de(b.current,0,250)),()=>{var m;(m=b.current)==null||m.pause()}},[D]),n.useEffect(()=>{const t=()=>{const a=[I.current,X.current,F.current,b.current].filter(Boolean);for(const c of a)try{const i=c.play();i&&typeof i.then=="function"&&i.then(()=>{c.pause(),c.currentTime=0}).catch(()=>{})}catch{}window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)};return window.addEventListener("pointerdown",t,{once:!0}),window.addEventListener("keydown",t,{once:!0}),()=>{window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t)}},[]);const C=t=>{var c;if(!D)return;const a=t==="tick"?I.current:t==="success"?X.current:F.current;if(a)try{a.currentTime=0,(c=a.play)==null||c.call(a)}catch{}};n.useEffect(()=>{if(_!=null)return;const a=(r.difficulty||"").toLowerCase(),i=(a==="hard"?20:a==="medium"?15:10)*60*1e3;R.current=i,Y.current=!1;const m=Date.now();K(m+i),W(i)},[r.difficulty,_]),n.useEffect(()=>{const t=setInterval(()=>{if(_==null)return;const a=Date.now(),c=Math.max(0,_-a);W(c),c<=1e4&&!Y.current&&(Y.current=!0,C("tick")),c===0&&!P.current&&(P.current=!0,O.post(`/api/match/${r.id}/timeout`).catch(()=>{}),A.fire({title:"Time's up!",text:"This match ended with no rewards.",icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back",confirmButtonColor:"#64748b"}).then(()=>window.location.href="/play/matchmaking"))},250);return()=>clearInterval(t)},[_]);const Oe=n.useMemo(()=>u==null?"—:—":ke(u),[u]),Ae=t=>{const a=t.id??t.submission_id??`${t.user_id}-${t.at??t.created_at??t.timestamp??""}`,c=String(a),i=t.is_correct??t.correct??0,m=typeof i=="boolean"?i:Number(i)===1,s=t.at??t.created_at??t.timestamp??new Date().toISOString(),L=new Date(s),$=Number.isNaN(L.getTime())?Date.now():L.getTime(),z=typeof t.by_me=="boolean"?t.by_me:typeof t.byMe=="boolean"?t.byMe:Number(t.user_id)===Number(r.me);return{id:c,byMe:z,correct:m,text:z?m?"You submitted: Correct!":"You submitted: Wrong.":m?"Opponent submitted: Correct!":"Opponent submitted: Wrong.",ts:$}},me=t=>t==="hard"?6:t==="medium"?4:3,ue=async t=>{var a,c,i;try{const m=await O.get(`/api/match/${t}/status`),s=(m==null?void 0:m.data)??m;if(s!=null&&s.opponent&&Te({id:Number(s.opponent.id),name:s.opponent.name,avatar_url:s.opponent.avatar_url}),s!=null&&s.ends_at){const p=s!=null&&s.server_now?new Date(s.server_now).getTime():Date.now(),g=new Date(s.ends_at).getTime(),w=Math.max(0,g-p);R.current=w,Y.current=!1,K(Date.now()+w),W(w)}else if(typeof(s==null?void 0:s.remaining_seconds)=="number"){const p=Math.max(0,s.remaining_seconds*1e3);R.current=p,Y.current=!1,K(Date.now()+p),W(p)}const L=Array.isArray(s==null?void 0:s.submissions)&&s.submissions.length>0?Math.max(...s.submissions.map(p=>{const g=p.at??p.created_at??p.timestamp??null,w=g?new Date(g).getTime():0;return Number.isFinite(w)?w:0})):0,$=((a=s==null?void 0:s.last)==null?void 0:a.at)??((c=s==null?void 0:s.last)==null?void 0:c.created_at)??null,z=$?new Date($).getTime():0,M=Math.max(L,z);if(M&&M<ie.current)return;if(Array.isArray(s==null?void 0:s.submissions)){const p=s.submissions.map(Ae).sort((f,y)=>f.ts-y.ts),g=[];for(const f of p)if(!oe.current.has(f.id)&&(oe.current.add(f.id),g.push(f),!f.byMe)){const y=!!f.correct;re(y?"correct":"wrong"),Me(y?"success":"fail"),Z(!0),$e({text:y?"Correct Solution!":"Wrong Solution",correct:y,time:new Date(f.ts).toLocaleTimeString()}),y?(H("smirk"),C("success"),Be(),setTimeout(()=>H("base"),1200),setTimeout(()=>Z(!1),1600)):(H("sad"),C("fail"),setTimeout(()=>H("think"),1200),setTimeout(()=>Z(!1),1500)),setTimeout(()=>re("idle"),2e3)}g.length>0&&je(f=>{const y=[...f,...g];return y.slice(Math.max(0,y.length-40))});const w=[...p].filter(f=>!f.byMe).sort((f,y)=>y.ts-f.ts)[0];w&&w.id!==ce.current&&(ce.current=w.id,A.fire({icon:w.correct?"success":"info",title:"Opponent Submitted!",text:w.correct?"They got it right!":"Their solution needs work.",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#1f2937",color:"#fff"}))}if(!P.current){if(s!=null&&s.finished)if(P.current=!0,Number(s==null?void 0:s.winner_user_id)===Number(r.me)){if(C("success"),!q.current){q.current=!0;try{await O.post(`/api/match/${r.id}/award`,{language:r.language,difficulty:r.difficulty})}catch{}}const g=me(r.difficulty);V(!0),await A.fire({title:"You win! 🎉",html:`<div class="text-zinc-300 text-sm">Great job — your solution passed the tests first.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${g} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}else C("fail"),V(!0),setTimeout(()=>V(!1),4e3),await A.fire({title:"Opponent won",html:`<div class="text-zinc-300 text-sm">They solved it first — good try!<br/>
                     <div class="mt-2 font-semibold text-rose-300">-1 ⭐</div></div>`,icon:"info",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Back to queue",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else if((i=s==null?void 0:s.last)!=null&&i.message&&String(s.last.message).toLowerCase()==="surrendered")if(P.current=!0,Number(s.last.user_id)===Number(r.me))await A.fire({title:"You surrendered",icon:"warning",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"OK",confirmButtonColor:"#64748b"}),window.location.href="/play/matchmaking";else{if(C("success"),!q.current){q.current=!0;try{await O.post(`/api/match/${r.id}/award`,{})}catch{}}const g=me(r.difficulty);V(!0),await A.fire({title:"Opponent surrendered 🏆",html:`<div class="text-zinc-300 text-sm">Victory by surrender.<br/>
                     <div class="mt-2 font-semibold text-emerald-300">XP awarded: ${g} • +1 ⭐</div></div>`,icon:"success",background:"#0f172a",color:"#e5e7eb",confirmButtonText:"Continue",confirmButtonColor:"#14b8a6"}),window.location.href="/dashboard"}}M&&(ie.current=M)}catch(m){console.error("Error fetching match status:",m)}},Be=()=>{const t=document.querySelector(".opp-avatar-wrap");t&&(t.classList.remove("avatar-ripple"),t.offsetWidth,t.classList.add("avatar-ripple"),setTimeout(()=>t.classList.remove("avatar-ripple"),900))};n.useEffect(()=>{let t=!0;ue(r.id);const a=setInterval(()=>{t&&ue(r.id)},1300);return()=>{t=!1,clearInterval(a)}},[r.id,r.me]);const De=async()=>{var t,a,c;try{const{data:i}=await O.post(`/api/match/${r.id}/submit`,{code:x});i!=null&&i.correct?j({type:"success",text:"✅ Correct! Finalizing…"}):(C("tick"),j({type:"error",text:"❌ Wrong — keep trying!"}))}catch(i){console.error("[SUBMIT ERROR]",((t=i==null?void 0:i.response)==null?void 0:t.data)||i),j({type:"error",text:((c=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:c.message)||"Submit failed."})}},[te,pe]=n.useState(!1),Ie=async()=>{var t,a;if(!te){pe(!0);try{await O.post(`/api/match/${r.id}/surrender`,{}),j({type:"error",text:"You surrendered."})}catch(c){j({type:"error",text:((a=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to surrender."})}finally{pe(!1)}}};return[...G].filter(t=>!t.byMe).sort((t,a)=>a.ts-t.ts)[0],e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:[e.jsx("style",{children:`
        .hide-app-header #app-header,
        .hide-app-header .app-header,
        .hide-app-header header[role="banner"] { display: none !important; }
      `}),e.jsxs(Ye,{breadcrumbs:[{title:"Home",href:"/dashboard"},{title:"Match",href:`/play/m/${r.id}`}],children:[e.jsx(Fe,{title:`Match ${r.id}`}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6",children:[e.jsx(nt,{active:Ce,type:"win"}),e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-indigo-400 via-fuchsia-400 to-cyan-400 bg-clip-text text-transparent",children:["1v1 Duel — ",r.language.toUpperCase()," / ",r.difficulty.toUpperCase()]}),e.jsx("span",{className:"text-zinc-400 text-sm hidden md:inline",children:"Both players received the same AI-generated challenge."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:["inline-flex items-center gap-2 rounded-lg px-3 py-1.5 border text-zinc-300",E==="ok"?"border-slate-700/60":"",E==="warning"?"border-amber-500/60 bg-amber-500/10":"",E==="danger"?"border-rose-500/60 bg-rose-500/10 animate-pulse":"",E==="muted"?"border-slate-700/60 opacity-70":""].join(" "),title:"Match timer",children:[e.jsx(He,{className:["w-4 h-4",E==="danger"?"text-rose-400":E==="warning"?"text-amber-400":"text-cyan-400"].join(" ")}),e.jsx("span",{className:"tabular-nums",children:Oe})]}),_&&u!=null&&e.jsx("div",{className:"w-40 h-1.5 bg-slate-800/60 rounded-full overflow-hidden ml-3",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-[width] duration-300",style:{width:R.current&&u!=null&&R.current>0?`${Math.max(0,Math.min(100,u/R.current*100))}%`:"0%"}})}),e.jsxs("button",{onClick:()=>Ne(t=>!t),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",title:"Toggle sounds",children:[D?e.jsx(Pe,{className:"w-4 h-4"}):e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:D?"SFX on":"SFX off"})]}),e.jsxs("button",{onClick:()=>Q(!0),className:"inline-flex items-center gap-2 rounded-lg border border-slate-700/60 px-3 py-1.5 text-zinc-300 hover:bg-slate-900/40",children:[e.jsx(be,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Live feed"})]}),e.jsx("button",{onClick:Ie,disabled:te||u!=null&&u<=0,className:"text-sm px-3 py-2 rounded-lg border border-slate-700/60 disabled:opacity-50 hover:bg-rose-900/20 transition-colors",children:te?"Surrendering…":"Surrender"}),e.jsxs("div",{className:"ml-2 hidden md:flex items-center gap-3 text-zinc-300",children:[e.jsx(fe,{className:"w-5 h-5"}),e.jsxs("span",{children:["you #",r.me]}),e.jsx("span",{className:"opacity-40",children:"vs"}),e.jsx(fe,{className:"w-5 h-5"}),e.jsxs("span",{children:["opponent #",r.opponent]})]})]})]}),h&&e.jsxs("div",{className:`mb-4 flex items-center gap-2 px-4 py-2 rounded-lg ${h.type==="success"?"bg-green-900/40 text-green-300":"bg-red-900/40 text-red-300"} animate-bounceIn`,children:[h.type==="success"?e.jsx(he,{className:"w-4 h-4"}):e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:h.text})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-cyan-400"}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:_e})]}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:Re})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"Your Code"}),e.jsx("textarea",{value:x,onChange:t=>v(t.target.value),className:"w-full h-[380px] md:h-[520px] rounded-lg bg-slate-950 border border-slate-700/60 p-3 text-sm text-zinc-100 font-mono focus:border-cyan-500/50 focus:ring-1 focus:ring-cyan-500/30 transition-colors",spellCheck:!1}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-zinc-500 flex items-center gap-2",children:[e.jsx(qe,{className:"w-3 h-3"})," ",ze," Tests",e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Qe,{className:"w-3 h-3"})," ",Ee,e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(Ge,{className:"w-3 h-3"})," ",Le]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:De,disabled:u!=null&&u<=0,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-cyan-500 to-indigo-600 text-white font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-95 hover:shadow-lg hover:shadow-cyan-500/20",children:"Submit Solution"}),ee&&e.jsxs("button",{onClick:()=>ye(!T),className:"px-3 py-2 rounded-lg border border-slate-700/60 text-xs flex items-center gap-1 hover:bg-slate-800/40 transition-colors",children:[e.jsx(Ke,{className:"w-4 h-4"}),T?"Hide Solution":"Show Solution"]})]})]}),T&&ee&&e.jsx("pre",{className:"mt-3 p-3 rounded-lg bg-black/40 text-green-300 text-xs overflow-x-auto border border-emerald-500/20",children:ee})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/50 overflow-hidden relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(et,{className:"w-4 h-4 text-amber-300"}),ae!=="idle"&&e.jsx("span",{className:`absolute -top-1 -right-1 w-2 h-2 rounded-full ${ae==="correct"?"bg-emerald-400 animate-ping":"bg-rose-400 animate-ping"}`})]}),e.jsx("h2",{className:"font-semibold text-zinc-100",children:"Opponent Activity"}),e.jsxs("span",{className:"ml-auto text-xs text-zinc-500 flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"})," Live"]})]}),e.jsxs("div",{className:"p-4 h-[460px] md:h-[560px] flex items-center justify-center relative",children:[ne&&e.jsx(ot,{type:ne,active:Se}),e.jsx("div",{className:"opp-avatar-wrap absolute",children:e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-full border-2 border-transparent"})}),N?e.jsxs("div",{className:"text-center space-y-6 w-full",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:`absolute inset-0 rounded-full ${N.correct?"border-4 border-emerald-500/30 bg-emerald-900/10 animate-ping-slow":"border-4 border-rose-500/30 bg-rose-900/10 animate-pulse"}`}),e.jsx("div",{className:"absolute inset-4 rounded-full border-2 border-slate-700/60"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l!=null&&l.avatar_url?e.jsx("img",{src:U||S(l.avatar_url,"think")||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-40 h-40 object-contain select-none
                                ${k==="think"?"animate-opp-breathe":""}
                                ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                                ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):N.correct?e.jsx(Ze,{className:"w-12 h-12 text-yellow-300 animate-bounce"}):e.jsx(se,{className:"w-12 h-12 text-rose-300 animate-pulse"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full ${N.correct?"bg-emerald-900/40 text-emerald-300 border border-emerald-500/40":"bg-rose-900/40 text-rose-300 border border-rose-500/40"} animate-bounceIn`,children:[N.correct?e.jsx(he,{className:"w-5 h-5"}):e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:N.text})]}),e.jsxs("div",{className:"text-xs text-zinc-400 flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"w-3 h-3"}),N.time]})]}),e.jsx("div",{className:"w-full max-w-xs mx-auto bg-slate-800/50 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-1000 ${N.correct?"bg-emerald-500":"bg-rose-500"}`,style:{width:N.correct?"100%":"65%"}})})]}):e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative mx-auto w-44 h-44 opp-avatar-wrap",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-indigo-500/20 animate-ping-slow"}),e.jsx("div",{className:"absolute inset-3 rounded-full border-2 border-indigo-500/10 animate-pulse-slow"}),l!=null&&l.avatar_url?e.jsx("img",{src:U||S(l.avatar_url,"think")||"",alt:"Opponent avatar",draggable:!1,loading:"eager",className:`w-44 h-44 object-contain select-none
                              ${k==="think"?"animate-opp-breathe":""}
                              ${k==="smirk"?"animate-opp-bounce avatar-glow-green":""}
                              ${k==="sad"?"animate-opp-shake avatar-glow-red":""}`}):e.jsx("div",{className:"w-44 h-44 rounded-full bg-indigo-600/20 grid place-items-center border-2 border-slate-700/60",children:e.jsx(Ve,{className:"w-12 h-12 text-indigo-300 animate-bounce-slow"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-zinc-200",children:l!=null&&l.name?`${l.name}'s turn…`:"Waiting for opponent"}),e.jsx("p",{className:"text-sm text-zinc-400 max-w-xs mx-auto",children:"Your opponent hasn’t made a submission yet. Stay focused on your solution!"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-700/60",children:e.jsxs("p",{className:"text-xs text-zinc-400 text-center",children:["The panel updates in real-time when your opponent submits a solution.",N&&N.correct&&e.jsx("span",{className:"block mt-1 text-emerald-300 font-medium",children:"They solved it correctly! Hurry up!"})]})})]})]})]})]}),ve&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end md:items-center md:justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>Q(!1)}),e.jsxs("div",{className:"relative w-full md:w-[640px] max-h-[80vh] overflow-hidden rounded-t-2xl md:rounded-2xl border border-slate-700/60 bg-slate-900/90 backdrop-blur",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/60 flex items-center justify-between",children:[e.jsxs("div",{className:"text-zinc-200 font-medium flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-cyan-400"}),"Live attempts"]}),e.jsx("button",{onClick:()=>Q(!1),className:"px-3 py-1.5 rounded-lg text-sm border border-slate-700/60",children:"Close"})]}),e.jsx("div",{className:"p-4 max-h-[65vh] overflow-y-auto",children:G.length===0?e.jsx("div",{className:"text-xs text-zinc-500",children:"No attempts yet."}):e.jsx("ul",{className:"space-y-1",children:[...G].sort((t,a)=>a.ts-t.ts).map(t=>e.jsxs("li",{className:"text-xs",children:[e.jsx("span",{className:t.correct?"text-green-300":"text-red-300",children:t.correct?"✔":"✖"})," ",t.text," ",e.jsxs("span",{className:"opacity-50",children:["(",new Date(t.ts).toLocaleTimeString(),")"]})]},t.id))})})]})]}),e.jsx("style",{children:`
        @keyframes bounceIn {
          0% { transform: scale(0.8); opacity: 0; }
          50% { transform: scale(1.1); }
          100% { transform: scale(1); opacity: 1; }
        }
        .animate-bounceIn { animation: bounceIn 0.5s ease-out; }
        
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin-slow { animation: spin-slow 3s linear infinite; }
        
        @keyframes ping-slow { 0% { transform: scale(1); opacity: 1; } 75%, 100% { transform: scale(2); opacity: 0; } }
        .animate-ping-slow { animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite; }
        
        @keyframes pulse-slow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* Avatar motions */
        @keyframes opp-breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.04); } }
        .animate-opp-breathe { animation: opp-breathe 3.2s ease-in-out infinite; }

        @keyframes opp-shake {
          0%, 100% { transform: translateX(0); }
          15% { transform: translateX(-10px) rotate(-1deg); }
          30% { transform: translateX(10px) rotate(1deg); }
          45% { transform: translateX(-6px) rotate(-1deg); }
          60% { transform: translateX(6px) rotate(1deg); }
          75% { transform: translateX(-3px) rotate(-1deg); }
        }
        .animate-opp-shake { animation: opp-shake 0.8s ease-in-out; }

        @keyframes opp-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-14px) scale(1.02); } }
        .animate-opp-bounce { animation: opp-bounce 0.8s ease-in-out; }

        /* Glow halos */
        .avatar-glow-green { box-shadow: 0 0 0 0 rgba(16,185,129,0.45); animation: glow-green 1.2s ease-out; border-radius: 16px; }
        .avatar-glow-red { box-shadow: 0 0 0 0 rgba(244,63,94,0.45); animation: glow-red 1.0s ease-out; border-radius: 16px; }
        @keyframes glow-green { 0%{ box-shadow: 0 0 0 0 rgba(16,185,129,0.55);} 100%{ box-shadow: 0 0 40px 10px rgba(16,185,129,0);} }
        @keyframes glow-red { 0%{ box-shadow: 0 0 0 0 rgba(244,63,94,0.55);} 100%{ box-shadow: 0 0 36px 8px rgba(244,63,94,0);} }

        /* Shockwave ripple (correct) */
        .avatar-ripple::after {
          content: '';
          position: absolute; inset: -8px;
          border: 3px solid rgba(16,185,129,0.45);
          border-radius: 9999px;
          animation: ripple 0.9s ease-out forwards;
        }
        @keyframes ripple { 0%{ transform: scale(0.7); opacity: 1;} 100%{ transform: scale(1.4); opacity: 0;} }

        /* Existing slow bounce for fallback */
        @keyframes bounce-slow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .animate-bounce-slow { animation: bounce-slow 2s ease-in-out infinite; }
      `})]})}export{Nt as default};
