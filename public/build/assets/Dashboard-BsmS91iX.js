import{r as c,j as e,K as ps,L as Ue}from"./app-1YLwgiEs.js";import{a as J,A as Be,T as ze}from"./app-layout-D1YC3rOg.js";import{A as us}from"./AnimatedBackground-DTDm-eQM.js";import{L as Oe}from"./loader-circle-CROBLGRg.js";import{A as fs}from"./activity-Bup5HV5b.js";import{M as Fe}from"./medal-Dzc2-fQX.js";import{S as O,U as gs,C as bs}from"./users-Bar0nC-w.js";import{Z as Ge}from"./zap-CE07kKtz.js";import{T as W}from"./trophy-DC8P4iJO.js";import{M as js,i as vs,u as Ze,P as Ns,a as ys,b as ws,L as _s,m as ks}from"./proxy-Ct5413vd.js";import{C as Cs}from"./crown-KZwCKzHR.js";import{C as Ss}from"./cpu-mYPax3Cj.js";import{T as Ye}from"./trending-up-HrFd5Gry.js";import{C as As}from"./circle-check-big-BQ_cUXoF.js";import{a as Ps,S as Ke}from"./x-DdFJWdk8.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-C6K1UtYD.js";class Ls extends c.Component{getSnapshotBeforeUpdate(r){const t=this.props.childRef.current;if(t&&r.isPresent&&!this.props.isPresent){const g=t.offsetParent,h=vs(g)&&g.offsetWidth||0,m=this.props.sizeRef.current;m.height=t.offsetHeight||0,m.width=t.offsetWidth||0,m.top=t.offsetTop,m.left=t.offsetLeft,m.right=h-m.width-m.left}return null}componentDidUpdate(){}render(){return this.props.children}}function $s({children:d,isPresent:r,anchorX:t,root:g}){const h=c.useId(),m=c.useRef(null),C=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:L}=c.useContext(js);return c.useInsertionEffect(()=>{const{width:I,height:p,top:A,left:u,right:x}=C.current;if(r||!m.current||!I||!p)return;const N=t==="left"?`left: ${u}`:`right: ${x}`;m.current.dataset.motionPopId=h;const j=document.createElement("style");L&&(j.nonce=L);const y=g??document.head;return y.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${I}px !important;
            height: ${p}px !important;
            ${N}px !important;
            top: ${A}px !important;
          }
        `),()=>{y.contains(j)&&y.removeChild(j)}},[r]),e.jsx(Ls,{isPresent:r,childRef:m,sizeRef:C,children:c.cloneElement(d,{ref:m})})}const Es=({children:d,initial:r,isPresent:t,onExitComplete:g,custom:h,presenceAffectsLayout:m,mode:C,anchorX:L,root:I})=>{const p=Ze(Ms),A=c.useId();let u=!0,x=c.useMemo(()=>(u=!1,{id:A,initial:r,isPresent:t,custom:h,onExitComplete:N=>{p.set(N,!0);for(const j of p.values())if(!j)return;g&&g()},register:N=>(p.set(N,!1),()=>p.delete(N))}),[t,p,g]);return m&&u&&(x={...x}),c.useMemo(()=>{p.forEach((N,j)=>p.set(j,!1))},[t]),c.useEffect(()=>{!t&&!p.size&&g&&g()},[t]),C==="popLayout"&&(d=e.jsx($s,{isPresent:t,anchorX:L,root:I,children:d})),e.jsx(Ns.Provider,{value:x,children:d})};function Ms(){return new Map}const se=d=>d.key||"";function He(d){const r=[];return c.Children.forEach(d,t=>{c.isValidElement(t)&&r.push(t)}),r}const Ts=({children:d,custom:r,initial:t=!0,onExitComplete:g,presenceAffectsLayout:h=!0,mode:m="sync",propagate:C=!1,anchorX:L="left",root:I})=>{const[p,A]=ys(C),u=c.useMemo(()=>He(d),[d]),x=C&&!p?[]:u.map(se),N=c.useRef(!0),j=c.useRef(u),y=Ze(()=>new Map),[V,te]=c.useState(u),[$,F]=c.useState(u);ws(()=>{N.current=!1,j.current=u;for(let w=0;w<$.length;w++){const f=se($[w]);x.includes(f)?y.delete(f):y.get(f)!==!0&&y.set(f,!1)}},[$,x.length,x.join("-")]);const X=[];if(u!==V){let w=[...u];for(let f=0;f<$.length;f++){const E=$[f],U=se(E);x.includes(U)||(w.splice(f,0,E),X.push(E))}return m==="wait"&&X.length&&(w=X),F(He(w)),te(u),null}const{forceRender:G}=c.useContext(_s);return e.jsx(e.Fragment,{children:$.map(w=>{const f=se(w),E=C&&!p?!1:u===$||x.includes(f),U=()=>{if(y.has(f))y.set(f,!0);else return;let B=!0;y.forEach(Y=>{Y||(B=!1)}),B&&(G==null||G(),F(j.current),C&&(A==null||A()),g&&g())};return e.jsx(Es,{isPresent:E,initial:!N.current||t?void 0:!1,custom:r,presenceAffectsLayout:h,mode:m,root:I,onExitComplete:E?void 0:U,anchorX:L,children:w},f)})})},Je=[{title:"Home",href:"/dashboard"},{title:"Dashboard",href:"/dashboard"}],Ws=d=>Math.floor(d/10)+1,qe=d=>d%10,Is=d=>qe(d)/10*100;function et(){var ge,be,je,ve,Ne,ye,we,_e,ke,Ce,Se,Ae,Pe,Le,$e,Ee,Me,Te,We,Ie,Re,De,Ve;const{auth:d}=ps().props,r=d==null?void 0:d.user,[t,g]=c.useState(null),[h,m]=c.useState([]),[C,L]=c.useState(!0),[I,p]=c.useState(!1),[A,u]=c.useState(null),[x,N]=c.useState([]),[j,y]=c.useState(0),[V,te]=c.useState("Current Season"),$=s=>{switch(s){case"Solo":return"bg-blue-900/30 border-blue-800 text-blue-300";case"Solo+AI":return"bg-indigo-900/30 border-indigo-800 text-indigo-300";case"Invite Duel":return"bg-rose-900/30 border-rose-800 text-rose-300";case"Live Match":return"bg-amber-900/30 border-amber-800 text-amber-300";case"Python":return"bg-emerald-900/30 border-emerald-800 text-emerald-300";case"Java":return"bg-orange-900/30 border-orange-800 text-orange-300";case"C++":return"bg-blue-900/30 border-blue-800 text-blue-300";default:return"bg-slate-900/30 border-slate-700 text-slate-300"}},F=s=>{if(!s)return null;const l=String(s).trim();return/^(https?:\/\/|data:)/i.test(l)||l.startsWith("/")?l:l.startsWith("avatars/")||l.startsWith("storage/")?`/${l}`:`/avatars/${l}`},X=s=>s?s.startsWith("SOLO_AI_")?"Solo+AI":s.startsWith("SOLO_")?"Solo":s.startsWith("PVP_INVITE_")?"Invite Duel":s.startsWith("PVP_LIVE_")?"Live Match":s.startsWith("LANG_PY_")?"Python":s.startsWith("LANG_JAVA_")?"Java":s.startsWith("LANG_CPP_")?"C++":"General":"General",G=s=>s&&typeof s=="object"&&("code"in s||"threshold"in s||"xp_reward"in s||"name"in s||"goal"in s),w=s=>{const l=Number(s.threshold??s.goal??0),a=Number(s.current??s.count??0),n=s.progress!=null?Number(s.progress):l>0?Math.min(100,Math.round(a/l*100)):0,i=Number.isFinite(n)?Math.max(0,Math.min(100,n)):0,v=l>0&&a>=l||i>=100,R=!!(s.claimed??s.is_claimed??!1),D=!!(s.unlocked??v),Q=!!(s.can_claim??(D&&!R)),P=s.code??s.key??s.name??"",S=s.name??s.title??s.code,b=s.description??s.desc,M=s.icon_key??s.icon,ee=s.xp_reward??s.xp,H=s.stars_reward??s.stars,k=s.scope??s.category??s.group;return{id:Number.isFinite(Number(s.id))?Number(s.id):void 0,code:String(P),name:String(S??"Achievement"),description:b??void 0,icon_key:M??null,threshold:l,current:a,progress:i,unlocked:D,claimed:R,can_claim:Q,xp_reward:Number(ee??0),stars_reward:Number(H??0),__scope:k??X(String(P))}},f=s=>{const l=[],a=i=>{if(!i)return;if(Array.isArray(i)){i.forEach(a);return}if(typeof i!="object")return;if(G(i)){l.push(w(i));return}const v=[i.items,i.achievements,i.tasks,i.groups,i.categories,i.data].filter(Boolean);v.length?v.forEach(a):Object.values(i).forEach(a)};a(s);const n=new Set;return l.filter(i=>{const v=i.id!=null?`id:${i.id}`:`code:${i.code}|scope:${i.__scope??""}`;return n.has(v)?!1:(n.add(v),!0)})};c.useEffect(()=>{E(!0)},[]);const E=async(s=!1)=>{var l,a,n,i,v,R,D,Q;try{s&&L(!0);const[P,S,b]=await Promise.all([J.get("/api/me/stats"),J.get("/api/users/participants"),J.get("/api/achievements/progress")]),M=((l=b==null?void 0:b.data)==null?void 0:l.items)??((a=b==null?void 0:b.data)==null?void 0:a.data)??(b==null?void 0:b.data)??b,ee=f(M);if(N(ee),ls){const H=ee.filter(k=>k.can_claim);for(const k of H)try{const o=await J.post("/api/achievements/claim",{achievement_id:k.id}),T=((n=o==null?void 0:o.data)==null?void 0:n.xp_reward)??k.xp_reward??0,oe=((i=o==null?void 0:o.data)==null?void 0:i.stars_reward)??k.stars_reward??0;fe({name:k.name,xp:T,stars:oe,icon_key:k.icon_key??void 0})}catch(o){console.error("Auto-claim failed",k.id,o)}}if(y(Number((M==null?void 0:M.solo_completed)??(M==null?void 0:M.completed)??((v=b==null?void 0:b.data)==null?void 0:v.solo_completed)??0)),P!=null&&P.success&&P.data&&(g(P.data),u(new Date)),S!=null&&S.success){const H=Array.isArray(S.data)?S.data:Array.isArray((R=S.data)==null?void 0:R.data)?S.data.data:[];(Q=(D=S.data)==null?void 0:D.season)!=null&&Q.name&&te(S.data.season.name);const k=H.map(o=>{var Xe;const T=Number(o.total_xp??o.season_xp??0),oe=Number(o.stars??o.season_stars??0),ms=Number(o.crowns??0),xs=o.last_season_rank??null,hs=F(o.avatar??((Xe=o.profile)==null?void 0:Xe.avatar)??null);return{id:o.id,name:o.name,email:o.email,avatar:hs,total_xp:T,stars:oe,level:Math.floor(T/10)+1,crowns:ms,last_season_rank:xs}}).sort((o,T)=>T.total_xp-o.total_xp||T.stars-o.stars).map((o,T)=>({...o,rank:T+1}));m(k)}}catch(P){console.error("Error fetching dashboard/leaderboard:",P)}finally{L(!1),p(!1)}},U=((ge=t==null?void 0:t.user)==null?void 0:ge.stars)??((be=t==null?void 0:t.totals)==null?void 0:be.stars)??0,B=(je=t==null?void 0:t.solo_stats)!=null&&je.total_attempts?Math.round(t.solo_stats.successful_attempts/t.solo_stats.total_attempts*100):0,Y=(ve=t==null?void 0:t.ai_stats)!=null&&ve.ai_attempts?Math.round(t.ai_stats.ai_successful_attempts/t.ai_stats.ai_attempts*100):0,de=(((Ne=t==null?void 0:t.solo_stats)==null?void 0:Ne.total_attempts)||0)+(((ye=t==null?void 0:t.ai_stats)==null?void 0:ye.ai_attempts)||0),me=(((we=t==null?void 0:t.solo_stats)==null?void 0:we.successful_attempts)||0)+(((_e=t==null?void 0:t.ai_stats)==null?void 0:_e.ai_successful_attempts)||0),ae=de>0?Math.round(me/de*100):0,Qe=(t==null?void 0:t.duels_played)??0,es=(t==null?void 0:t.duels_won)??0,ss=(t==null?void 0:t.live_played)??(t==null?void 0:t.matches_played)??0,ts=(t==null?void 0:t.live_won)??(t==null?void 0:t.matches_won)??0,le=Qe+ss,xe=es+ts,as=le?Math.round(xe/le*100):0,re=h.find(s=>s.id===(r==null?void 0:r.id)),K=(re==null?void 0:re.rank)??null,[he,pe]=c.useState(null),ls=!0,[rs,Z]=c.useState(!1),ne=c.useRef(null);c.useEffect(()=>{const s=a=>{ne.current&&(ne.current.contains(a.target)||Z(!1))},l=a=>{a.key==="Escape"&&Z(!1)};return document.addEventListener("mousedown",s),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",l)}},[]);const[ns,ue]=c.useState([]),fe=s=>{const l=`${Date.now()}-${Math.random().toString(36).slice(2)}`;ue(a=>[...a,{id:l,...s}]),setTimeout(()=>ue(a=>a.filter(n=>n.id!==l)),3500)},is=async s=>{var l,a;try{pe(s);const n=x.find(D=>D.id===s),i=await J.post("/api/achievements/claim",{achievement_id:s}),v=((l=i==null?void 0:i.data)==null?void 0:l.xp_reward)??(n==null?void 0:n.xp_reward)??0,R=((a=i==null?void 0:i.data)==null?void 0:a.stars_reward)??(n==null?void 0:n.stars_reward)??0;fe({name:(n==null?void 0:n.name)||"Achievement",xp:v,stars:R,icon_key:(n==null?void 0:n.icon_key)??void 0}),await E(!1)}catch(n){console.error("Claim failed",n)}finally{pe(null)}},q=Ws(((ke=t==null?void 0:t.totals)==null?void 0:ke.xp)||0),ie=qe(((Ce=t==null?void 0:t.totals)==null?void 0:Ce.xp)||0),cs=Is(((Se=t==null?void 0:t.totals)==null?void 0:Se.xp)||0),os=s=>s===1?{label:"Gold",className:"text-yellow-400",chip:"bg-yellow-500/15 border-yellow-700"}:s===2?{label:"Silver",className:"text-slate-200",chip:"bg-slate-400/10 border-slate-500"}:s===3?{label:"Bronze",className:"text-amber-500",chip:"bg-amber-500/10 border-amber-600"}:{label:"",className:"text-slate-300",chip:"bg-slate-800 border-slate-700"},z=({title:s,right:l,children:a,className:n=""})=>e.jsxs("section",{className:`bg-slate-800/50 border border-slate-700 rounded-2xl p-5 ${n}`,children:[e.jsxs("header",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-semibold tracking-wide",children:s}),l]}),a]}),ce=({icon:s,label:l,value:a})=>e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900/60 border border-slate-700 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-800 border border-slate-700",children:e.jsx(s,{className:"h-5 w-5 text-cyan-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:l}),e.jsx("p",{className:"text-base font-semibold text-white",children:a})]})]}),ds=({value:s})=>e.jsx("div",{className:"w-full h-3 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-cyan-500 via-blue-500 to-fuchsia-500",style:{width:`${s}%`}})}),_=({title:s,value:l,icon:a,description:n,tone:i="slate"})=>{const v={slate:"bg-slate-900/60 border-slate-700 text-slate-200",green:"bg-emerald-900/30 border-emerald-800 text-emerald-300",indigo:"bg-indigo-900/30 border-indigo-800 text-indigo-300",amber:"bg-amber-900/30 border-amber-800 text-amber-300",rose:"bg-rose-900/30 border-rose-800 text-rose-300",purple:"bg-purple-900/30 border-purple-800 text-purple-300",cyan:"bg-cyan-900/30 border-cyan-800 text-cyan-300",blue:"bg-blue-900/30 border-blue-800 text-blue-300",yellow:"bg-yellow-900/30 border-yellow-800 text-yellow-300",red:"bg-red-900/30 border-red-800 text-red-300"};return e.jsx("div",{className:`rounded-xl border p-4 ${v[i]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:l}),n&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:n})]})]})})};return C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950",children:e.jsxs(Be,{breadcrumbs:Je,children:[e.jsx(Ue,{title:"Dashboard"}),e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Oe,{className:"h-8 w-8 animate-spin mx-auto mb-3 text-cyan-400"}),e.jsx("div",{className:"text-slate-300",children:"Loading your dashboard…"})]})})]})}):e.jsxs("div",{className:"min-h-screen relative overflow-x-hidden scroll-smooth",children:[e.jsx("div",{className:"pointer-events-none fixed inset-0 -z-10","aria-hidden":"true",children:e.jsx(us,{})}),e.jsxs(Be,{breadcrumbs:Je,children:[e.jsx(Ue,{title:"Dashboard"}),e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fs,{className:"h-7 w-7 text-cyan-400"}),e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:["Welcome back, ",r==null?void 0:r.name,"!"]})]}),e.jsxs("p",{className:"text-slate-400",children:["Ready for your next coding challenge?",A&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• Updated ",A.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-400 mb-1",children:(V==null?void 0:V.toUpperCase())||"CURRENT SEASON"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[K!=null&&e.jsx(ce,{icon:Fe,label:"Rank",value:`#${K}`}),e.jsx(ce,{icon:O,label:"Season Stars",value:((Ae=h.find(s=>s.id===(r==null?void 0:r.id)))==null?void 0:Ae.stars)??0}),e.jsx(ce,{icon:Ge,label:"Season XP",value:((Pe=h.find(s=>s.id===(r==null?void 0:r.id)))==null?void 0:Pe.total_xp)??0})]})]}),e.jsxs("div",{ref:ne,className:"relative",children:[e.jsxs("button",{onClick:()=>Z(s=>!s),className:"inline-flex items-center gap-2 rounded-xl px-4 py-2 bg-slate-800 border border-slate-700 text-white hover:bg-slate-700",title:"View Achievements",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{children:"Achievements"})]}),e.jsx(Ts,{children:rs&&e.jsx(ks.div,{initial:{opacity:0,y:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-6,scale:.98},transition:{type:"spring",stiffness:380,damping:28,mass:.6},className:"absolute right-0 mt-2 w-[28rem] max-w-[90vw] z-[60]",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-900/95 shadow-2xl backdrop-blur p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("h3",{className:"text-white font-semibold tracking-wide text-sm",children:"Achievements"})]}),e.jsx("button",{onClick:()=>Z(!1),className:"inline-flex items-center justify-center rounded-lg border border-slate-600 text-slate-200 hover:bg-slate-800 w-7 h-7",title:"Close",children:"✕"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"My Trophies"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.filter(s=>s.claimed).length===0?e.jsx("span",{className:"text-slate-500 text-xs",children:"No trophies yet."}):x.filter(s=>s.claimed).slice(0,12).map(s=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-700 bg-slate-900/60 px-2 py-1",children:[s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,alt:s.icon_key||"trophy",className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-[11px] text-white truncate max-w-[180px]",title:s.name,children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-slate-400 mb-2",children:"Tasks"}),x.filter(s=>!s.claimed).length===0?e.jsx("div",{className:"text-slate-400 text-sm",children:"No tasks available."}):(()=>{const s=a=>a.can_claim?3:a.unlocked?2:a.progress>0?1:0,l=[...x].filter(a=>!a.claimed).sort((a,n)=>{const i=s(n)-s(a);return i!==0?i:n.progress-a.progress});return e.jsx("div",{className:"space-y-2 max-h-[45vh] overflow-y-auto pr-1",children:l.slice(0,8).map(a=>{const n=X(a.code);return e.jsx("div",{className:`rounded-xl border p-3 ${a.unlocked?"bg-yellow-900/10 border-yellow-800":"bg-slate-900/60 border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg border bg-black/20",children:a.icon_key?e.jsx("img",{src:`/trophies/${a.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("p",{className:"text-white font-medium truncate",title:a.name,children:a.name}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full border ${$(n)}`,children:n})]}),a.can_claim?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-amber-900/30 border border-amber-800 text-amber-300",children:"Ready to claim"}):a.unlocked?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-yellow-900/20 border border-yellow-800 text-yellow-300",children:"Completed"}):a.progress>0?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-cyan-900/30 border border-cyan-800 text-cyan-300",children:"In progress"}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-slate-800 border border-slate-600 text-slate-300",children:"Locked"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-2 rounded-full bg-slate-700 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a.unlocked?"bg-gradient-to-r from-yellow-400 to-amber-500":"bg-gradient-to-r from-cyan-500 to-blue-500"}`,style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mt-1",children:[e.jsxs("span",{children:[Math.min(a.current,a.threshold)," / ",a.threshold]}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-[10px] text-slate-400",children:["Reward: ",e.jsxs("span",{className:"text-white font-medium",children:["+",a.xp_reward," XP"]})," •"," ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",a.stars_reward]})]}),a.can_claim&&e.jsx("button",{onClick:()=>is(a.id),disabled:he===a.id,className:"text-[11px] inline-flex items-center gap-2 px-2.5 py-1 rounded-lg border border-yellow-700 bg-yellow-500/10 text-yellow-200 hover:bg-yellow-500/20 disabled:opacity-60",children:he===a.id?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-3.5 w-3.5 animate-spin"}),"Claiming…"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3.5 w-3.5"}),"Claim"]})})]})]})]})]})},a.id)})})})()]})]})})})]})]})]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs(z,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Level & Progress"})]}),right:e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-slate-400",children:"Next Level"}),e.jsxs("div",{className:"font-semibold text-cyan-300",children:[10-ie," XP needed"]})]}),children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white text-lg font-semibold",children:["Level ",q]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",ie,"/10 XP)"]})]})}),e.jsx(ds,{value:Math.round(cs)}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2",children:[e.jsxs("span",{children:["Level ",q]}),e.jsxs("span",{children:[ie," / 10 XP"]}),e.jsxs("span",{children:["Level ",q+1]})]})]}),e.jsxs(z,{title:"Your KPIs",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Total XP",value:((Le=t==null?void 0:t.totals)==null?void 0:Le.xp)||0,icon:Ge,tone:"yellow"}),e.jsx(_,{title:"Total Attempts",value:((($e=t==null?void 0:t.solo_stats)==null?void 0:$e.total_attempts)||0)+(((Ee=t==null?void 0:t.ai_stats)==null?void 0:Ee.ai_attempts)||0),icon:ze,tone:"blue"}),e.jsx(_,{title:"Solo Attempts",value:((Me=t==null?void 0:t.solo_stats)==null?void 0:Me.total_attempts)||0,icon:gs,tone:"indigo"}),e.jsx(_,{title:"AI Attempts",value:((Te=t==null?void 0:t.ai_stats)==null?void 0:Te.ai_attempts)||0,icon:Ss,tone:"cyan"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(_,{title:"Overall Success",value:`${ae}%`,icon:Ye,description:`${me} successful attempts`,tone:ae>70?"green":ae>50?"blue":"amber"}),e.jsx(_,{title:"Solo Success",value:`${B}%`,icon:As,description:`${((We=t==null?void 0:t.solo_stats)==null?void 0:We.successful_attempts)||0} successful solo attempts`,tone:B>70?"green":B>50?"blue":"amber"}),e.jsx(_,{title:"AI Success",value:`${Y}%`,icon:Ps,description:`${((Ie=t==null?void 0:t.ai_stats)==null?void 0:Ie.ai_successful_attempts)||0} successful AI attempts`,tone:Y>70?"green":Y>50?"blue":"amber"})]})]}),e.jsx(z,{title:"Duel Performance",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Stars Earned",value:U,icon:O,description:"Achievement stars",tone:"purple"}),e.jsx(_,{title:"Duels Played",value:le,icon:Ke,description:"Total matches (invite + live)",tone:"red"}),e.jsx(_,{title:"Duels Won",value:xe,icon:W,description:"Victories (invite + live)",tone:"green"}),e.jsx(_,{title:"Win Rate",value:`${as}%`,icon:Ye,description:"Success percentage",tone:"indigo"})]})}),e.jsx(z,{title:"Today's Activity",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-blue-900/30 border border-blue-800 mb-2",children:e.jsx(ze,{className:"h-6 w-6 text-blue-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((Re=t==null?void 0:t.solo_stats)==null?void 0:Re.attempts_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Solo Attempts Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex p-3 rounded-xl bg-rose-900/30 border border-rose-800 mb-2",children:e.jsx(Ke,{className:"h-6 w-6 text-rose-300"})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(t==null?void 0:t.duels_today)||0}),e.jsx("p",{className:"text-sm text-slate-400",children:"Duels Started Today"})]})]})}),(t==null?void 0:t.language_stats)&&t.language_stats.length>0&&e.jsx(z,{title:"Language Proficiency",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols- gap-4",children:t.language_stats.map(s=>e.jsx(_,{title:s.language,value:`${s.winrate}%`,icon:bs,description:`${s.games_played} games played`,tone:s.winrate>70?"green":s.winrate>50?"blue":"amber"},s.id))})})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(z,{title:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{children:"Leaderboard"})]}),e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:V})]}),right:e.jsx("span",{className:"text-xs text-slate-400",children:"XP • Stars"}),className:"xl:sticky xl:top-4 xl:self-start",children:[h.slice(0,3).length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:h.slice(0,3).map(s=>{const l=os(s.rank);return e.jsxs("div",{className:`rounded-xl p-3 border ${l.chip} text-center`,children:[e.jsx("div",{className:"mt-2 mx-auto w-12 h-12 rounded-full overflow-hidden ring-1 ring-slate-700/60",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Fe,{className:`h-5 w-5 ${l.className}`}),e.jsxs("span",{className:`text-sm font-semibold ${l.className}`,children:["#",s.rank]})]}),e.jsx("div",{className:"mt-1 text-white text-sm font-bold truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"text-[11px] text-slate-400",children:["Lvl ",s.level]}),e.jsxs("div",{className:"mt-1 text-xs text-cyan-300",children:[s.total_xp," XP"]})]},s.id)})}),e.jsxs("div",{className:"divide-y divide-slate-700/70 overflow-y-visible no-scrollbar",children:[h.slice(3,15).map(s=>e.jsxs("div",{className:"py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:`text-sm font-bold ${s.rank<=3?"text-yellow-400":"text-slate-300"}`,children:["#",s.rank]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:s.avatar||"/avatars/default.png",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-white font-medium truncate ${s.id===(r==null?void 0:r.id)?"underline decoration-dotted":""}`,title:s.name,children:s.id===(r==null?void 0:r.id)?"You":s.name}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",s.level]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.total_xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id)),h.length===0&&e.jsx("div",{className:"py-8 text-center text-slate-400",children:"No participants yet."})]}),K!=null&&K>15&&e.jsxs("div",{className:"mt-3 rounded-xl border border-cyan-800 bg-cyan-900/20 p-3",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Your Position"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 text-center",children:e.jsxs("span",{className:"text-sm font-bold text-cyan-300",children:["#",K]})}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden ring-1 ring-slate-700/60 shrink-0",children:e.jsx("img",{src:F(((De=r==null?void 0:r.profile)==null?void 0:De.avatar)??(r==null?void 0:r.avatar)??null)||"/avatars/default.png",alt:r==null?void 0:r.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium truncate",children:"You"}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-cyan-900/40 border border-cyan-800 text-cyan-300",children:["Lvl ",q]})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[((Ve=t==null?void 0:t.totals)==null?void 0:Ve.xp)??0," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",U]})]})]})]})]})]})})]}),e.jsx("div",{className:"fixed top-4 right-4 z-[60] space-y-2",children:ns.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-yellow-700 bg-slate-900/90 backdrop-blur px-4 py-3 shadow-lg",children:[e.jsx("div",{className:"p-2 rounded-lg border border-yellow-700 bg-yellow-500/10",children:s.icon_key?e.jsx("img",{src:`/trophies/${s.icon_key}.svg`,className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm text-white font-semibold truncate",title:s.name,children:["Achievement Unlocked: ",s.name]}),e.jsxs("p",{className:"text-xs text-slate-300",children:["+",s.xp," XP • ",e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 text-yellow-400"})," ",s.stars]})]})]})]},s.id))})]}),e.jsx("style",{children:`
  .no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `})]})}export{et as default};
