import{K as te,r as a,j as e,L as T}from"./app-OhlekuTl.js";import{A as _,b as ae}from"./app-layout-B5IsOpVm.js";import{S as re}from"./sweetalert2.esm.all-acGi8jXx.js";import{A as le}from"./AnimatedBackground-BQYBUBuJ.js";import{R as ne}from"./refresh-cw-rEtdXzRU.js";import{B as ie,X as oe}from"./x-Rd-GQEUr.js";import{C as I}from"./users-C2rxOQZ1.js";import{L as $}from"./lightbulb-DTFzIReu.js";import{F as ce}from"./filter-BDn3D4r5.js";import{S as de}from"./search-Bf-61_Hs.js";import{C as xe}from"./chart-column-BsOpfcON.js";import{E as me}from"./eye-off-UT--zesY.js";import{E as he}from"./eye-McWN5nHv.js";import{C as ue}from"./circle-check-big-Ba7g9xIk.js";import{A as ge}from"./arrow-left-Dk0vvSlH.js";import{A as fe}from"./arrow-right-BXXuxzcS.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-BgRTU6rU.js";const M=[{title:"Home",href:"/dashboard"},{title:"Practice",href:"#"},{title:"Review Mode",href:"/play/practice"}];function _e(){var Q,q;const{auth:j}=te().props;j==null||j.user;const[v,C]=a.useState([]),[l,O]=a.useState([]),[i,u]=a.useState(0),[S,k]=a.useState(null),[o,A]=a.useState(!1),[g,y]=a.useState(!1),[f,B]=a.useState("python"),[h,J]=a.useState("all"),[p,z]=a.useState(""),[H,E]=a.useState(!0),[K,W]=a.useState([]),[L,w]=a.useState(new Set),N=a.useRef(null),X=((Q=document.querySelector('meta[name="csrf-token"]'))==null?void 0:Q.content)||((q=window.Laravel)==null?void 0:q.csrfToken)||"",[V,pe]=a.useState(!0);a.useRef(null);const c=s=>{if(V)try{ae.play(s)}catch{}};a.useEffect(()=>{R()},[f]),a.useEffect(()=>{Y()},[v,h,p,L]);const R=async()=>{const s=new AbortController;try{E(!0);const t=await fetch(`/practice/current?language=${f}`,{signal:s.signal});if(!t.ok)throw new Error("Failed to fetch current set");const x=await t.json(),{set:m,progress:n}=x;N.current={id:m.id,filename:m.filename,total_questions:m.total_questions};const F=await fetch(`/data/${m.filename}`,{signal:s.signal});if(!F.ok)throw new Error(`Failed to load ${m.filename}`);const P=await F.json();C(P),W([...new Set(P.map(se=>se.category))]);const ee=Array.isArray(n==null?void 0:n.taken_ids)?n.taken_ids:[];w(new Set(ee)),b(),u(0)}catch(t){(t==null?void 0:t.name)!=="AbortError"&&(console.error("Error loading questions:",t),C([]),re.fire({icon:"error",title:"Loading Error",text:"Failed to load questions or set metadata. Make sure the routes and JSON files exist."}))}finally{E(!1)}return()=>s.abort()},Y=()=>{let s=v;if(h!=="all"&&(s=s.filter(t=>t.category===h)),p.trim()){const t=p.toLowerCase();s=s.filter(x=>x.question.toLowerCase().includes(t)||x.category.toLowerCase().includes(t))}s=s.filter(t=>!L.has(t.id)),O(s),u(t=>Math.min(t,Math.max(0,s.length-1)))},b=()=>{k(null),A(!1),y(!1)},r=l[i],d=o&&S===(r==null?void 0:r.answer),D=async()=>{if(r&&N.current){w(s=>new Set(s).add(r.id));try{await fetch("/practice/taken",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":X},body:JSON.stringify({question_set_id:N.current.id,question_id:r.id})})}catch(s){console.error("Failed to mark taken",s)}}i<l.length-1?(u(s=>s+1),b()):await R()},G=()=>{i>0&&(u(s=>s-1),b())},U=()=>y(s=>!s),Z=s=>{o||!r||(c("click"),k(s),A(!0),y(!0),s===r.answer?c("success"):c("failure"))};return H?e.jsxs(_,{breadcrumbs:M,children:[e.jsx(T,{title:"Practice Review"}),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ne,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-blue-400"}),e.jsx("div",{className:"text-gray-300",children:"Loading questions..."})]})})]}):e.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[e.jsx(le,{}),e.jsxs(_,{breadcrumbs:M,children:[e.jsx(T,{title:"Practice Review"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4 relative z-10",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ie,{className:"h-8 w-8 text-blue-400"}),e.jsx(I,{className:"h-6 w-6 text-purple-400"}),e.jsx($,{className:"h-8 w-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"PRACTICE REVIEWywfbgvsjvsd"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Review programming questions and learn from explanations"})]})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"lg:w-1/3 flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ce,{className:"h-5 w-5 text-purple-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Question Filters"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Language"}),e.jsxs("select",{value:f,onChange:s=>B(s.target.value),className:"w-full px-4 py-3 bg-gray-900/50 border border-gray-600 rounded-lg text-gray-200",children:[e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"java",children:"Java"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),e.jsxs("select",{value:h,onChange:s=>J(s.target.value),className:"w-full px-4 py-3 bg-gray-900/50 border border-gray-600 rounded-lg text-gray-200",children:[e.jsx("option",{value:"all",children:"All Categories"}),K.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:p,onChange:s=>z(s.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-900/50 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(xe,{className:"h-5 w-5 text-green-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Session Stats"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Total Questions:"}),e.jsx("span",{className:"text-blue-300 font-medium",children:l.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Current Progress:"}),e.jsxs("span",{className:"text-purple-300 font-medium",children:[l.length===0?0:i+1,"/",l.length]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Language:"}),e.jsx("span",{className:"text-green-300 font-medium capitalize",children:f})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Category:"}),e.jsx("span",{className:"text-yellow-300 font-medium",children:h==="all"?"All":h})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[e.jsx("span",{children:"Completion"}),e.jsxs("span",{children:[l.length>0?Math.round((i+1)/l.length*100):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.length>0?(i+1)/l.length*100:0}%`}})})]})]})]}),e.jsx("div",{className:"lg:w-2/3",children:l.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-12 text-center",children:[e.jsx(I,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl text-gray-300 mb-2",children:"No Questions Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You may have completed all questions for this set/filter."}),e.jsx("button",{onClick:()=>{w(new Set),u(0),b()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Revisit Questions in This Set"})]}):r&&e.jsxs("div",{className:"bg-gray-900/60 rounded-xl shadow-lg overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 flex items-center justify-between",children:[e.jsx("div",{className:"bg-white/20 px-3 py-1 rounded-full text-white text-sm font-medium shadow-md",children:r.category}),e.jsxs("button",{onClick:()=>{U(),c("hover")},className:"flex items-center space-x-2 px-4 py-2 bg-white/10 hover:bg-white/20 text-white font-medium rounded-lg shadow transition",children:[g?e.jsx(me,{className:"h-4 w-4"}):e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:g?"Hide Answer":"Show Answer"})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"mb-6 p-4 bg-gray-800/40 border border-gray-700 rounded-lg",children:e.jsx("p",{className:"text-xl text-white font-semibold leading-relaxed whitespace-pre-line",children:r.question.split(/(`[^`]+`)/g).map((s,t)=>s.startsWith("`")?e.jsx("code",{className:"bg-gray-700 px-2 py-1 rounded text-purple-300 font-mono text-base",children:s.replace(/`/g,"")},t):s)})}),o&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-semibold ${d?"bg-green-900/40 text-green-200":"bg-rose-900/40 text-rose-200"}`,children:[d?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(oe,{className:"h-4 w-4"}),d?"Correct":"Incorrect"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-6",children:r.choices.map((s,t)=>{const x=s===r.answer,m=s===S;let n="p-4 rounded-lg border cursor-pointer transition-all ";return g?x?n+="bg-green-900/50 border-green-400 text-green-100":o&&m&&!x?n+="bg-rose-900/50 border-rose-400 text-rose-100":n+="bg-gray-900/20 border-gray-700 text-gray-400":n+="bg-gray-900/30 border-gray-600 text-gray-300 hover:border-gray-400",e.jsx("div",{className:n,onClick:()=>Z(s),onMouseEnter:()=>c("hover"),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-full border flex items-center justify-center",children:String.fromCharCode(65+t)}),e.jsx("span",{className:"font-mono",children:s})]})},t)})})]}),g&&e.jsxs("div",{className:`mx-8 mb-6 rounded-lg p-6 border ${o?d?"bg-green-900/20 border-green-500/30":"bg-rose-900/20 border-rose-500/30":"bg-blue-900/20 border-blue-500/30"}`,children:[e.jsxs("h4",{className:`font-bold mb-2 flex items-center ${o&&!d?"text-rose-300":"text-green-400"}`,children:[e.jsx($,{className:"h-5 w-5 mr-2"})," Explanation"]}),e.jsx("p",{className:`${o&&!d?"text-rose-100":"text-green-200"}`,children:o?d?r.explanation_correct:r.explanation_wrong:r.explanation_correct})]}),e.jsxs("div",{className:"bg-gray-900/30 px-8 py-4 flex justify-between",children:[e.jsxs("button",{onClick:()=>{G(),c("click")},disabled:i===0,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg disabled:opacity-50",children:[e.jsx(ge,{className:"h-4 w-4 inline"})," Previous"]}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[i+1," / ",l.length]}),e.jsxs("button",{onClick:()=>{D(),c("click")},disabled:i===l.length-1,className:"px-4 py-2 bg-blue-600 text-white rounded-lg disabled:opacity-50",children:["Next ",e.jsx(fe,{className:"h-4 w-4 inline"})]})]})]})})]})]})]})]})}export{_e as default};
